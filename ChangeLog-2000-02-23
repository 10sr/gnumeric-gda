1999-08-29  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/functions/fn-financial.c: Implemented ACCRINTM(), INTRATE(),
 	RECEIVED(), PRICEDISC(), and PRICEMAT().

	* src/func.h, src/functions/fn-date.c: Made get_date public.

1999-08-29  Morten Welinder  <terra@diku.dk>

	* src/functions/fn-lookup.c (gnumeric_indirect): Plug leak.

	* src/format.c (pre_parse_format): Don't overrun string.
	(format_number): Plug leak.

	* src/workbook.c (workbook_do_destroy): Typo.

1999-08-28  Miguel de Icaza  <miguel@gnu.org>

	* src/dialogs/*.glade.h: Make sure every dialog box has updated
	.glade.h and add glade.h generation to the summary, names and
	import glade files.

1999-08-28  Karl Eichwalder  <ke@suse.de>

	* gnumeric.desktop: Sort entries.
	(Name): Add `de'.
	(Comment): Ditto.

	* src/dialogs/dialog-zoom.c (dialog_zoom): Help xgettext to
	recognize the strings as `no-c-format'.
	* src/formats.c: Ditto.
	* src/gnumeric-sheet.c: Ditto.

1999-08-27  Karl Eichwalder  <ke@suse.de>

	* src/workbook.c: Typo.
	* src/workbook.c (sheet_action_delete_sheet): Change messages
	string.
	* src/workbook.c (sheet_action_delete_sheet): Ditto.

1999-08-26  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/functions/fn-financial.c: Implemented ISPMT().
	
1999-08-25  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* samples/finfuns.xls: Fixed the test of MIRR.

	* src/functions/fn-financial.c: Implemented FVSCHEDULE().
	
1999-08-24  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/functions/fn-financial.c: Implemented TBILLEQ() and started
	MIRR().
	
1999-08-23  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/functions/fn-financial.c: Implemented TBILLPRICE() and
 	TBILLYIELD().
	
1999-08-22  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/dialogs/dialogs-solver.c: Fixed a lot of things, memory
 	leaks and bugs.  The backend is still not there (but wait, one of
 	these days it may get there).

	* src/dialogs/dialogs.h, src/dialogs/dialogs-analysis-tools.c:
 	hbox_pack_label_and_entry made public.

	* src/collect.[ch], src/functions/fn-financial.c: Removed
 	collect_dates.  Added a flag COLLECT_DATES to
 	callback_function_collect instead.
	
1999-08-22  Miguel de Icaza  <miguel@gnu.org>

	* src/main.c (gnumeric_main): New Bonobos need to issue the
	bonobo_activate() call.

1999-08-21  Miguel de Icaza  <miguel@gnu.org>

	* src/workbook.c (workbook_new_with_sheets): Fixed hardcoded
	buffer. 

1999-08-20  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* samples/finfuns.xls: Made all the dates to use DATE() function
	instead of using strings in scandinavian style.
	
1999-08-20  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-financial.c: Made the last two arguments of PMT and PPMT
 	optional.
	
1999-08-20  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-financial.c: DDB() implemented.

	* src/fn-stat.c: QUARTILE() implemented.
	
1999-08-20  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* po/de.po: Removed the last bogus msgid to make it compile again.

	* src/sheet.c (sheet_insert_object): Added #if ENABLE_BONOBO to
 	make it compile without BONOBO.

	* src/gnumeric-sheet.c (gnumeric_sheet_drag_data_get): Ditto.

	* src/collect.[ch]: Wrote collect_dates and collect_dates_value.

	* src/fn-financial.c: DB() and XNPV() implemented.  DOLLARDE() and
 	DOLLARFR() fixed.

	* src/fn-date.c, src/func.h: get_serial_date made public.

	* TODO: Killed the four functions above from the todo list.
	
1999-08-19  Miguel de Icaza  <miguel@gnu.org>

	* src/workbook.c (workbook_container_get_object): Finish
	implementing this routine for responding to monikers.
	(create_graphic_cmd): temporarily bind this to
	Generic Bonobo object insertion.
	(cb_sheet_check_dirty): Make the dialog parent be the workbook
	window. 

	* src/workbook.h (Workbook): Include a GnomeUIHandler.
	
	* src/sheet.c (sheet_insert_object): Enable this function again
	and update it to match the latest Bonobo developments.

	* src/sheet.h (Sheet): Include a pointer to the active object
	frame. 

	* src/sheet-object.c (sheet_set_mode_type): Do deactivation of
	Bonobo frames here.

	*  src/gnumeric-sheet.c (gnumeric_drag_data_get): Beginning of
	drag and drop support for Bonobo monikers.

	* src/item-grid.c (drag_start): More DnD support for Gnumeric
	selections using Monikers.

	* src/sheet-object-container.c (user_activation_request_cb,
	view_activated_cb, get_file_name): New routines for dealing with
	the Bonobo object action in Gnumeric.

	(sheet_object_container_land): Do object selection here for now.
	Support both PersistStream and PersistFile

	* src/sheet-object.c: 

	* src/workbook.c (cb_sheet_check_dirty): Bind the dialog to the
	main window.

1999-08-20  Michael Meeks  <michael@imaginator.com>

	* src/cell.c (cell_set_text_simple): Add checks for over/under
	flow on integer reading... fall back to double values.

1999-08-16  Michael Meeks  <michael@imaginator.com>

	* src/fn-lookup.c (gnumeric_indirect): Fix leak
	Update to use new cellref_*_get functions.

	* src/parser.y (return_cellref): Use new function.

	* src/sheet.c (cellref_get): Implemented
	(cellref_a1_get): Snarf from parser.y :-)
	(cellref_r1c1_get): Implemented.

1999-08-17  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/workbook.c (workbook_class_init): Added cell_content_changed
	signal.  
	(workbook_do_destroy): Do not enable widgets to be focused.

	* src/cell.c (cell_content_changed): Calls workbook_cell_changed.
	This is for Paolo and his speech system for GNOME.
	
	* configure.in: New bonobo detection code and support for not
	compiling Bonobo support even if it is present on the system
	
1999-08-17  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* samples/statfuns.xls: Updated the tests of LINEST and TREND to
	cover more possible cases.

1999-08-15  Jody Goldberg <jgoldberg@home.com>

	* src/format.c (split_time) : Use a integer to avoid problems with
	  rounding when compiling with optimization.  Be extra careful to
	  round the result of the initial scaling.

	* src/sheet-view.c (vertical_scroll_event, horizontal_scroll_event) :
	  Only move and append to the selection if the cursor actually moves.

	* src/dialog-function-wizard.c (arg_data_list_new) : Constness.

	* src/expr.c (eval_expr_real) : Add OPER_PERCENT.
	(do_expr_decode_tree) : Ditto.
	(expr_dump_tree) : Ditto.

	* src/expr.h : Ditto.

	* src/parser.y : Add function build_unary_op, and support
	  exp '%'.  Precedence is a GUESS.

1999-08-16  Michael Meeks  <michael@imaginator.com>

	* src/widget-editable-label.c (el_start_editing): Remove
	GTK_WIDGET_SET/UNSET_FLAGS (GTK_CAN_FOCUS): broken for
	scrolling notebooks.
	(el_stop_editing): ditto.

	* src/workbook.c (workbook_setup_sheets): remove
	unset FOCUS on notebook.

1999-08-15  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-stat.c: Implemented TREND (mostly).  Made the second
 	argument of LINEST optional.

1999-08-15  Jody Goldberg <jgoldberg@home.com>

	* src/expr.c (eval_expr_real) : Don't free empty cells
	  in OPER_CONCAT.

1999-08-14  Jody Goldberg <jgoldberg@home.com>

	* src/clipboard.c (clipboard_release) : Use the original
	  row/col to calculate offsets when pasting cells that relocate
	  references.
	(clipboard_copy_cell_range) : Handle relocation.

	* src/expr.c (do_expr_decode_tree) : Duplicate the error message
	  because someone is going to free it.
	(expr_relocate) : New Function.

	* src/cell.c (cell_relocate) : Use expr_relocate.
	(cell_copy) : Don't NULL out the row/col/sheet
	  in the copied cell.  It gets reset on entry and is useful
	  information.
	(paste_cell) : Handle relocate.
	(clipboard_copy_cell_range) : Ditto.

	* cell.h : Differentiate CELL_COPY_TYPE_CELL into
	CELL_COPY_TYPE_CELL_ABSOLUTE or CELL_COPY_TYPE_CELL_RELATIVE,
	to deal with cut vs paste.

	* src/sheet-autofill.c : Use cell_relocate to test for out of bounds.

1999-08-14  Jody Goldberg <jgoldberg@home.com>

	* src/workbook.c (wb_edit_key_pressed) : Support F4 toggling
	  abs/relative.

	* src/expr.h : Constify FunctionDefinition.

	* src/fn-information.c : Use 'Red' instead of 'red' to match XL.

	* src/func.c (function_get_category, fn_def_init,
		      function_add_nodes, function_add_args) : Constify.

1999-08-15  Morten Welinder  <terra@diku.dk>

	* src/fn-stat.c (gnumeric_frequency): Fix leak (bin_array).  Fix
 	leak (data_cl.entries).  Fix leak (bin_cl.entries).  Fix leak
 	(floats for data).  Fix leak (floats for bins).  Fix leak (count).
	(gnumeric_linest): Simplify.
	(gnumeric_intercept): Simplify.
	(gnumeric_slope): Simplify.
	(gnumeric_forecast): Simplify.

	* src/collect.c (collect_floats_value): Make non-static.
	(float_range_function2): Plug leak.

	* src/Makefile.am (GNUMERIC_BASE_SOURCES): Add regressions.[ch].

	* src/style.c (style_font_unref): Fix obsolete warning.

1999-08-12  Kjartan Maraas  <kmaraas@online.no>

	* src/fn-math.c: Typo fixes.
	
1999-08-12  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-stat.c: Implemented the simplest case of LINEST()
 	function.
	
1999-08-12  Jody Goldberg <jgoldberg@home.com>

	* src/fn-date.c (gnumeric_date) : Fix typo that was moving us 1900
	  years into the future.

	* src/formats.c (cell_format_numbers) :  Use 'Red' rather than 'red'
	  to match XL better.

1999-08-11  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c ( move_cursor_horizontal, move_cursor_vertical,
	  move_horizontal_selection, move_vertical_selection,
	  selection_cursor_move_horizontal, selection_cursor_move_vertical) :
	  selection_expand_horizontal, selection_expand_vertical) :
	  Support Ctrl-Arrow which jumps to the boundaries of non-blank
	  ranges.

	* src/sheet.c (sheet_find_boundary_vertical,
	  sheet_find_boundary_horizontal) :  New functions, to find the start
	  and end of ranges.  They also ensure that the corner which was moved
	  stays visible.
	(sheet_selection_extend_vertical) : Use sheet_find_boundary_vertical.
	(sheet_selection_extend_horizontal) : Use sheet_find_boundary_horizontal.

1999-08-11  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-string.c: Fixed the rounding of DOLLAR() function.

	* src/fn-financial.c: Some minor cleaning.

	* src/func.h: Added prototypes for callback_function_make_list.
	
	* src/fn-stat.c: Fixed PROB() function.

1999-08-11  Michael Meeks  <michael@imaginator.com>

	* plugins/text/text-io.c: Prototypes updated.

1999-08-11  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* TODO: Updated the remaining work of build-in functions.

	* src/fn-stat.c: Implemented FREQUENCY().

1999-08-09  Miguel de Icaza  <miguel@gnu.org>

	* src/xml-io.c (xml_workbook_write): Handle locale switching here.
	(xml_workbook_read): Handle locale switching here.

	* src/file.c: Removed all references to saving and re-setting the
	locale.  This should be handled in the xml-io code.

1999-08-10  Miguel de Icaza  <miguel@gnu.org>

	* src/workbook.c (workbook_do_destroy): remove g_free from the
	workbook.  We are now a GtkObject.

1999-08-09  Miguel de Icaza  <miguel@gnu.org>

	* src/xml-io.c (xml_workbook_write): Move the locale
	setting/resetting here, instead of putting it all over the place.

1999-08-09    <miguel@gnu.org>

	* src/xml-io.c (xml_workbook_read): Adjusted to use the new file
	open convention.

	* src/file.h: File open methods now take a workbook as an argument
	instead of creating it themselves.  Required for the
	GNOME::Persist bonobo interfaces.

	* src/file.c (workbook_read): Fix the workbook creation order to
	keep the locale correct if the file did not exist.

1999-08-10  Morten Welinder  <terra@diku.dk>

	* src/workbook.c (workbook_do_destroy): Don't free the workbook
 	ourselves.

1999-08-10  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* samples/statfuns.xls: Updated the tests of functions returning
	array values.

	* samples/dbfuns.xls: Added a test for GETPIVOTDATA function.
	Also added a very simple pivot table.
	
1999-08-10  Michael Meeks  <michael@imaginator.com>

	* TODO, DEPENDS, doc/Future-Roadmap, doc/Design: Updated,
	and added short plugin design section.

	* doc/saving.txt: Added short section on Summary Information.

1999-08-10  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-math.c: Finished ROMAN().  Gnumeric now supports all the
 	60 mathematical functions of Excel 2000.

1999-08-10  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-math.c: Added MDETERM().

1999-08-09  Michael Meeks  <michael@imaginator.com>

	* src/workbook.c (workbook_class_init): Moved hack to workbook.h,
	and removed comment.

1999-08-09  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/fn-math.c: Added MINVERSE().

1999-08-09  Michael Meeks  <michael@imaginator.com>

	* src/sheet.c (sheet_cell_add): Optimise by checking last
	element of the list for a simple append before calling
	g_list_insert_sorted. CRowSort took up way too much time in my
	profile :-). [ This fix is quite temporary ]

	* src/workbook.c (workbook_init): Conditionaly compile bonobo
	specific code.
	(workbook_class_init): Grotesque hack so it compiles.

1999-08-08  Jacob Berkman  <jberkman@andrew.cmu.edu>

	* src/workbook.c: use smaller menu stock icon instead of large one

1999-08-06  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/xml-io.c (xml_write_summary): I think this is the correct
	fix.  We should not add childs if no summary info is available.

	* src/corba-sheet.c (Sheet_cell_set_font): Use the standard
	procedure to set the font.

	* src/cell.c: deleted finally cell_set_font.

	* src/workbook.c: Reorganization to make the code be a GtkObject.
	Redone the destruction bits of the Workbook.

	* src/workbook.h: Split sheet.h into workbook.h and sheet.h

	* src/workbook.h: Now the Workbook is a GtkObject or a
	GnomeObject, depending on the compilation flags.

1999-08-05  Morten Welinder  <terra@diku.dk>

	* src/dialog-printer-setup.c (dialog_print_info_destroy): Plug
 	leaks.

	* src/print-info.c (hf_format_render): Plug leak.
	(render_opcode): Constify.

	* src/item-cursor.c (item_cursor_autofill_event): Don't unref, but
 	destroy.  We no longer own the ref.

1999-08-05  Michael Meeks  <michael@imaginator.com>

	* src/file.c (workbook_import): Fix control flow to have 1 return.
	fix leak.

1999-08-05  Jody Goldberg <jgoldberg@home.com>

	* src/func.c (function_get_category) : Lookup/store in sorted list.

1999-08-05  Morten Welinder  <terra@diku.dk>

	* src/cell.c (cell_set_font): Obsolete -- #if 0 for now.

	* src/cell.h: Remove now-static cell_formula_changed,
 	calc_text_dimensions, and cell_set_font.

	* src/dialog-analysis-tools.c (add_output_frame): Plug leak.

1999-08-05  Michael Meeks  <michael@imaginator.com>

	* src/file.c (workbook_import): Major hacks to get round quirks
	in libglade.

	* src/import.glade: Add label to the container.

1999-08-04  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/cell.c (calc_text_dimensions): Made static.
	(queue_cell): Killed dependency_deep_frozen routines, this was
	archaic code. 
	(cell_formula_changed): Made static.

	* src/sheet-autofill.c (autofill_register_list): Make static.

1999-08-03  Michael Meeks  <michael@imaginator.com>

	* src/workbook.c (workbook_setup_edit_area): Removed function
	wizard.

1999-08-03  Miguel de Icaza  <miguel@gnu.org>

	* src/corba-sheet.c (fill_corba_value): Corrected the argument here.
	
1999-08-03  Jody Goldberg <jgoldberg@home.com>

	* src/plugin.h (struct) : 'private' is a C++ keyword.

	* src/sheet.h : Add GHashTable *dependency_hash to sheet.

	* src/sheet.c (sheet_destroy) : Clear dependency_hash.

	* src/eval.c (dependency_hash_init) : dependency_hash sheet specific.
	(add_cell_range_dep) : Ditto.
	(cell_add_dependencies) : Ditto.
	(cell_drop_dependencies) : Ditto.
	(region_get_dependencies) : Ditto.
	(cell_get_dependencies) : Ditto.
	(add_cell_range_dep) : Increment ref_count AFTER looking for duplicates.

	* src/workbook.c (workbook_do_destroy) : Add some debugging code to
          catch dangling dependancies.

1999-07-27  Miguel de Icaza  <miguel@gnu.org>

	* src/corba-workbook-factory.c (WorkbookFactory_read): Duplicate
	CORBA Object server here.
	(WorkbookFactory_create_object): and here.

1999-08-03  Robert Brady  <rwb197@ecs.soton.ac.uk>
 
        * gnumeric.spec.in, README: require gnome-print 0.3 or greater.
	(BUGFIX #1829)

1999-08-02  Morten Welinder  <terra@diku.dk>

	* src/expr.c (eval_expr_real): Handle integer operations more
 	carefully with respect to overflow.

	* src/cell.c (cell_cleanout): Don't unlink unless there is a sheet
 	to unlink from.

	* src/collect.c (float_range_function2): Actually call the right
 	function.
	(collect_floats_value): Fix type of result.

	* src/mathfunc.c (range_rsq_pop, range_rsq_est): New functions.

	* src/fn-stat.c (gnumeric_pearson): Simplify.
	(gnumeric_rsq): Simplify.

1999-08-02  Jody Goldberg <jgoldberg@home.com>

	* src/fn-information.c (gnumeric_n) : Fix boolean support.

	* src/corba-sheet.c: Correct previous typo.

1999-08-02  Elliot Lee <sopwith@redhat.com>

	* gnumeric.spec.in: Fix the .spec file to include correct
 	documentation pieces.

	* doc/C/Makefile.am: Work with builddir != srcdir

	* plugins/lotus-123/Makefile.am: boot.h not needed. lotus-types.h is.

	* plugins/xbase/Makefile.am: boot.h not needed.

	* po/Makefile.in.in: v3

	* src/corba-sheet.c: Use a compilable thing for error string.

1999-08-02  Morten Welinder  <terra@diku.dk>

	* src/expr.c (eval_expr_real): Plug leak...

1999-08-02  Jody Goldberg  <jgoldberg@home.com>

	* src/expr.c (eval_expr_real): Fix bool <-> number comparisons to match
          excel approach.  TRUE&FALSE > numbers.

	* src/item-bar.c (item_bar_event) : Button3 should select the
          current row/col before bringing up the edit menu.

	* src/sheet.c (sheet_cell_foreach_range) : return NULL not FALSE
          on precondition failure.

	* src/value.[ch] : Add value_area_foreach

	* src/fn-date.c (gnumeric_networkdays) : Correct the modulo for
          weekends and add support for holidays via value_area_foreach.

	* src/sheet.c : Correct some documentation

1999-08-01  Jody Goldberg  <jgoldberg@home.com>

	* samples/operator.xls : Test workbook for operators.

	* src/Gnumeric.idl : Add VALUE_ERROR, VALUE_BOOLEAN, VALUE_EMPTY
          in a few more places
	* src/fn-lookup.c : Ditto.
	* src/fn-math.c : Ditto.
	* src/fn-stat.c : Ditto.
	* src/fn-string.c : Ditto.
	* src/dialog-cell-sort.c : Ditto.
	* src/corba-sheet.c : Ditto.

	* src/fn-eng.c : Support VALUE_BOOLEAN and simplify comparison logic in
          DELTA and GESTEP.

	* src/expr.c (compare_bool_bool) : New function.
          (compare_int_int, compare_float_float) : Take (Value *) and do cast
          internally.
	  (is_null_string) : Rename to value_is_empty_cell, support VALUE_EMPTY.
            and move to src/value.c.
	  (compare) : Rework to bring into closer compliance with XL.
          (expr_eval_real) : Ditto, replace 'Type [Mm]ismatch' with '#!VALUE'.
          use eval_expr rather than eval_expr_real for arithmetic binary
	  operators.  Use value_get_as_float rather than value_cast_to_float.
          (eval_expr) : Remap 'VALUE_EMPTY' to int(0)

	* src/value.h : Adjust enumeration so that BOOLEAN < INTEGER < FLOAT
	    remove value_cast_to_float

	* src/value.c (value_get_as_*) : Support NULL values.
	  (value_cast_to_float) : Remove.

	* src/sheet.c (sheet_cell_formula_unlink) : Add precondition to handle
          problems using deleted cells.

1999-08-01  Morten Welinder  <terra@diku.dk>

	* src/fn-stat.c (gnumeric_covar, gnumeric_correl): Simplify using
 	range functions.

	* src/workbook.c (file_open_cmd): Plug leak.

	* src/mathfunc.c (range_covar, range_correl_pop,
 	range_correl_est): New functions.

	* src/collect.c (collect_floats_value, float_range_function2): New
 	functions.

1999-08-01  Michael Meeks  <michael@edenproject.org>

	* src/workbook.c (workbook_setup_sheets): Added comment about making
	workbook sheets' notebooks scrollable.

	* src/fn-database.c (gnumeric_dmin, gnumeric_dmax, gnumeric_daverage):
	Only use the value if it is a number.
	(find_column_of_field): Use g_strcasecmp instead of strcmp.
	(criteria_test_equal, unequal): ditto; test this.

	* src/fn-information.c (gnumeric_cell): Changed broken cell_fetch's
	to cell_gets.

1999-08-01  Jody Goldberg  <jgoldberg@home.com>

	* src/fn-date.c (get_serial_date): Constify.  Improve handling of
 	date_serial 0.
	(gnumeric_networkdays): Add partial implementation.  (MW: turned
 	off.)

	* src/eval.c (add_value_deps): Handle empty value.

	* src/collect.c (callback_function_collect): Ignore empty values.

	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) : Support
	<C-PgUp> <C-PgDown> moving through the sheets.

	* src/Gnumeric.idl : Add VALUE_ERROR, VALUE_BOOLEAN, VALUE_EMPTY
	in a few more places.

	* src/corba-sheet.c : Ditto.

	* src/value.c (value_new_empty): New function.
	(value_dump, value_copy_to, value_get_as_bool,
 	value_get_as_string, value_get_as_int, value_get_as_float): Handle
 	empty value.

1999-08-01  Morten Welinder  <terra@diku.dk>

	* src/expr-name.c (expr_name_add): Fix bogus check.
	(expr_name_remove): Abort until someone fixes this.

	* src/style.c (style_font_unref): Unref the font.

	* src/expr.c (eval_expr_real): Fix OPER_CONCAT case.  From Jody.

	* src/value.c (value_cast_to_float): FMR fix from Jody.

1999-08-01  Manish Vachharajani  <mvachhar@vger.rutgers.edu>

	* src/sheet-object-container.c: fix reference to
	gnome_client_site_bind_bonobo_object to read
	gnome_client_site_bind_embeddable

1999-08-01    <jrb@redhat.com>

	* src/workbook.c: move the about-entry lower to make it more
	consistent with the rest of GNOME.

1999-08-01  Morten Welinder  <terra@diku.dk>

	* src/format.c (format_number): YAL -- yet another leak.

	* src/fn-string.c (gnumeric_text): Plug leak.

	* src/expr.c (do_expr_tree_unref): Plug array value leak.

	* src/cell.c (cell_set_array_formula): Unref the wrappers so we
 	don't leak a reference.

	* src/fn-math.c (gnumeric_countif): Initialise total_num member.

1999-07-31  Morten Welinder  <terra@diku.dk>

	* src/fn-database.c (free_criterias): Plug massive leak.
	(parse_database_criteria): Plug leak.
	(parse_criteria): Constify.
	(find_column_of_field): Plug leak.
	(parse_database_criteria): Plug leak.
	(gnumeric_dproduct): Plug leak.
	(gnumeric_dvar): Plug leak.
	(gnumeric_dmin): Plug leak.
	(find_column_of_field): Plug leak.

	* src/fn-math.c (gnumeric_seriessum): Plug leak.
	(gnumeric_subtotal): Plug leak.

	* src/fn-lookup.c (gnumeric_address): Fix memory corruption.

1999-07-31  Robert Meeks   <robert@imaginator.com>

	* src/fn-information.c (translate_table): Populated.
	
1999-07-31  Michael Meeks  <michael@edenproject.org>

	* src/fn-information.c (gnumeric_cell): Implemented col, row,
	address, contents. Start of format.
	(translate_cell_format): Start of format translation.

1999-07-31  Morten Welinder  <terra@diku.dk>

	* src/fn-logical.c (gnumeric_if): Fix case of first argument
 	yielding an error.

	* src/expr.c (expr_dump_tree): Constify.

	* src/func.c (function_iterate_do_value): Fix behaviour of strict
 	functions.

	* src/expr.c (do_expr_tree_invalidate_references): Handle
 	VALUE_BOOLEAN and VALUE_ERROR.
	(eval_expr_real): Make comparisons strict.

	* src/summary.c (summary_info_free): Fix leak.
	(summary_item_free): Fix leak.

	* src/fn-misc.c (gnumeric_iserror): Fix leak.
	(gnumeric_error_type): Fix leaks.
	(gnumeric_isna): Fix leak.
	(gnumeric_iserr): Fix leak.

	* src/fn-information.c (get_value_class): Fix leak.

1999-07-31  Michael Meeks  <michael@edenproject.org>

	* src/fn-information.c (gnumeric_isref): Implemented.

1999-07-30  James Youngman  <jay@gnu.org>

	* src/fn-eng.c (gnumeric_besseli): Implemented.
	(gnumeric_besselk): Implemented.
	(eng_functions_init): Add relevant inits.
	Include mathfunc.h

1999-07-30  Morten Welinder  <terra@diku.dk>

	* src/cell.c (cell_cleanout): New function.
	(cell_set_formula): Don't bother with CELL_ERROR.  Set value field
 	in all cases.
	(cell_set_array_formula): Set cell values.
	(cell_set_value_simple): Simplify using cell_cleanout.
	(cell_set_text_simple): Ditto.
	(cell_set_formula_tree_simple): Ditto.
	(cell_destroy): Ditto.
	(cell_get_text): Simplify.
	(cell_get_content): Ditto.

	* src/eval.c (cell_eval): Reorganise slightly.

	* src/expr.c (eval_expr_real): value should no longer be null.

	* src/cell.h (CELL_ERROR): Obsolete.

	* src/print-info.h (hf_formats): Make extern.

	* src/summary.h (summary_item_name): Make extern.

1999-07-29  Michael Meeks  <michael@edenproject.org>

	* src/cell.c (cell_set_text_simple): Chomp whitespace off the
	end of integers ( other spreadsheets do this ).

1999-07-28  Michael Meeks  <michael@edenproject.org>

	* src/summary.c: Update, was out of step with the header.

1999-07-28  Michael Meeks  <michael@edenproject.org>

	* src/item-grid.h: Added border_gc[BORDER_MAX] to ItemGrid.

	* src/item-grid.c (item_grid_draw_cell): Border rendering code.
	Make rendering conditional on debug - this looks awful.
	(item_grid_realize): ditto + struct of types in style_border_data.
	(item_grid_unrealize): clean up after myself.

1999-07-27  Jody Goldberg  <jgoldberg@home.com>

	* src/fn-date.c : Add EOMONTH, and partial WORKDAY.

	* src/formats.c : Add more date formats.

	* src/fn-math.c (gnumeric_transpose) : no need for an array
          if the input is a singleton.

	* src/expr.c : Add comment explaining the need for a re-org
          to correctly handle implicit intersetion vs arrays with
          operators.  Move all value_* functions into.

	* src/value.c : Here.

	* src/func.c : Move const value initialization into value.c.

	* src/clipboard.c (clipboard_prepend_cell) : Return Value * as per
          change to VALUE_ERROR.

	* src/style.h : Add STYLE_ORIENT_MAX to remove ugly magic number
          that will change when we add support for diagonals.

	* src/print-cell.c (print_cell_border, print_border) : Use enum
	  rather than hard coding the number of border types.

	* TODO : Add implicit intersection for operators.

1999-07-25  Jody Goldberg  <jgoldberg@home.com>

	* plugins/guile/plugin.c,
	  plugins/python/python.c
	  src/{Makefile.am, cell.[ch], collect.[ch], eval.c, expr-name.c,
	       expr.[ch], fn-database.c, fn-date.c, fn-eng.c, fn-financial.c,
	       fn-information.c, fn-logical.c, fn-lookup.c, fn-math.c,
	       fn-misc.c, fn-sheet.c, fn-stat.c, fn-string.c, format.c,
	       func.[ch], sheet-object-container.c, sheet.[ch]}
	  : Add VALUE_ERROR, VALUE_BOOLEAN, Change many signatures to return
	    Value for errors.

	* icons/chart_*.png : Add Some images in preparation for re-enabling
	  the graph wizard.

	* src/expr.c (eval_funcall) : When a single row or column is passed to
	  a function expecting a single value, take the intersection of the
	  evaluation position and the range.
	(cell_ref_get_abs_col, cell_ref_get_abs_row) : New functions.

	* src/value.[ch] : New files with Value support routines split out from
	  expr.[ch]

1999-07-26  Michael Meeks  <michael@edenproject.org>

	* src/corba-sheet.c (fill_corba_value): Remove redundant Sheet *
	from cellref_name.

1999-07-26  Michael Meeks  <michael@edenproject.org>

	* src/xml-io.c (xml_read_cell): Commented out freeze/thaw deps.

	* src/cell.c (cell_deep_freeze_dependencies): Added warning not to
	use: strangely it doesn't work... investigate later.

1999-07-25  Michael Meeks  <michael@edenproject.org>

	* src/xml-io.c (xml_read_cell): Add freeze/thaw dependencies,
	and fix exit condition to restore state to correct coolness.

	* src/cell.h: Added prototypes.

	* src/cell.c (cell_content_changed, cell_formula_changed): 
	(cell_deep_thaw_dependencies, cell_deep_freeze_dependencies): 
	Added optimisation for load/save stuff.

1999-07-25  Michael Meeks  <michael@edenproject.org>

	* src/xml-io.c (xml_read_summary): Fix some massive cock-ups, how
	did this ever work.
	(xml_read_names): ditto.
	(xml_workbook_read): Shifted read_names down to where we actualy
	have the inter-sheet reference names in place.

	* src/expr.c (expr_tree_invalidate_references): Debugging that
	needs cleaning to new PP stuff #if-def'd out.
	(expr_tree_fixup_references): ditto.

	* src/xml-io.c (xml_write_names, xml_read_names): Implemented
	(xml_workbook_write, xml_workbook_read): Hooks added, but reading
	disabled: something dodgy somewhere.

	* src/sheet.c (sheet_lookup_by_name): Fixed to use simply a
	Workbook pointer.

	* src/workbook.c (workbook_set_auto_expr): Fix old hack using
	new PP stuff.

	* src/sheet.c (sheet_fill_selection_with): Updated to new PP code.

	* src/parser.y (gnumeric_expr_parser): Updated to new PP code,
	removed redundant and nasty _unsafe_expr_parser hack. Essentialy
	nothing new, but removes daft parser_sheet and replaces with
	parser_workbook, leaving sheet stuff to the evaluation stage.

	* src/dialog-define-names.c: Major fixups, killed obscure bug
	cause by freeing a copy of a list I passed to gtk_list_append_items.

	* src/expr.c (expr_parse_string, do_expr_decode_tree): 
	(expr_decode_tree): Updated to new 

	* src/expr-name.c (expr_name_create): Added for convenience.
	(expr_name_value): Updated to new PP scheme

	* src/cell.c (cell_set_formula, cell_get_text, cell_get_content): 
	Update to new ParsePosition scheme.

	* src/expr.c (parse_pos_init, parse_pos_cell): Created.

	* src/expr.h: Add ParsePosition & prototpes

1999-07-25  Michael Meeks  <michael@edenproject.org>

	* src/dialog-define-names.c (update_edit): use expr_name_value.
	(grab_text_ok): Update to use new functions.

	* src/expr-name.c (expr_name_value): Added.
	(expr_name_create): Convenience function

	* src/xml-io.c (xml_workbook_write): Added names writing.

1999-07-24  Michael Meeks  <michael@edenproject.org>

	* src/expr-name.c (expr_name_add): Add check for circular
	references in (name_refer_circular): created.
	(add_real): More paranoia.

1999-07-23  Michael Meeks  <michael@edenproject.org>

	* src/expr-name.c (expr_name_list): Expand.
	(expr_name_remove): Serious bug freeing names.
	(expr_name_lookup): precondition.
	(expr_name_remove): more sanity checks.

	* src/dialog-define-names.c (fill_list): Append instead of inserting
	items. use "select" signal, hand the correct pointer on.
	Implemented guts, fixed lots of bugs.
	
1999-07-25  Karsten Weiss  <karsten@addx.au.s.shuttle.de>

	* src/print.glade.h: Fixed three typos.
	* src/hf-config.glade.h: Fixed a typo.
	Is this the right place to fix the typos or are they auto-generated
	from some other source?
	
1999-07-21  Miguel de Icaza  <miguel@gnu.org>

	* src/dialog-printer-setup.c (preview_page_destroy): Clear the
	pointers after unrefing.

	* src/print.c (setup_rotation): Add the rotation code for the
	vertical/horizontal printing.

1999-07-22  Michael Meeks  <michael@edenproject.org>

	* src/dialog-define-names.c (dialog_define_names): Removed all the
	dead code.
	Lots of new code ... not there yet though.
	
	* src/workbook.c: Enabled names menu item.

	* src/dialog-summary.c: add file header.

	* src/Makefile.am (glade_DATA): Added summary.glade and names.glade
	seems I didn't do this earlier: odd.

	* names.glade: Created.
	
1999-07-22  Michael Meeks  <michael@edenproject.org>

	* src/expr-name.c: Stylistic precondition fixes,
	simplification & workbook integration.

	* src/workbook.c (workbook_core_new): init names.
	(workbook_do_destroy): add name clean.

	* src/sheet.h: Add Workbook->names.

	* src/func.h: Added comments moved from expr.h

1999-07-21  Richard Hestilow  <hestgray@ionet.net>
	
	* gnumeric.gnorba: Fix "Embeddable" typo 
	(was IDL:/GNOME/Embeddable, should have been IDL:GNOME/Embeddable)

1999-07-21  Michael Meeks  <michael@edenproject.org>

	* src/widget-font-selector.c (fs_init): Convert g_error to
	g_warning on missing glade_xml_new.

	* src/Makefile.am (GNUMERIC_CORBA_GENERATED): Make this empty
	if BONOBO is not installed, should kill peoples Gnumeric.idl
	problems with luck.

	* configure.in: Add lotus-123

	* plugins/Makefile.am: ditto.

	* src/main.c: Remove xbase include.

1999-07-20  Jody Goldberg  <jgoldberg@home.com>

	* src/expr.c (value_area_fetch_x_y) : make value_zero local.
	(eval_expr) : renamed eval_expr_real, and allowed it to return NULL
	  in all the places that make sense.
	(eval_expr) : New function.  Calls eval_expr_real and returns 0 on
	  NULL with no error set.  Until VALUE_ERROR is in place things
	  will look funny.

1999-07-20  Miguel de Icaza  <miguel@gnu.org>

	* src/item-bar.c (bar_draw_cell): Move the dimension computaiton
	of the font after we have figured which font to use.  Before we
	did all the computaiton based on the default font, which is not
	always the font used (we use bold font for selected rows).

	This fixes the bug Morten reported.

1999-07-20  Jody Goldberg  <jgoldberg@home.com>

	* src/fn-math.c : Moved gpow10 from here.
	* src/utils.[ch] : to here.

	* src/expr.c (value_area_get_x_y) : return NULL in all cases of
	  invalid refernces dont fake a 0.
	Rename TYPE_ERROR -> TYPE_MISMATCH.
	(is_null_string) : New function.
	(compare) : Allow equality tests between empty/error things too.
	(eval_expr) : Allow comparisons of empty/error values.  It can handle
	  it now.
	(OPER_ARRAY) : Use value_area_get_x_y not fetch_x_y, handle empty/error.
	(value_get_as_string) : Fix typo in recent unlogged change.  The change
	  might break importing files from a different locale.

	* src/fn-string.c : Add TEXT, improve VALUE, REPLACE so that they
	  passes more tests.

	* src/number-match.c (compute_value) : Partial support for thousands
	  separator.  Why doesn't this code use locale ?

	* src/format.c (format_value) : better support for ranges, attempt to
	  work around problem of a thousands seperator in a date format.

	* src/cell-draw.c (cell_draw) : Fix potential for infinite loop
	  with HALIGN_FILL.
	* src/print-cell.c (print_cell_text) : Ditto.

	* src/parser.y (make_string_return) : A string of the form "..." is
	  a string, don't try to parse it as a number.

	* src/pattern-selector.[ch] : pattern_selector_select made static. In
	  preparation for different approach.

1999-07-19  Andreas Voegele <andreas.voegele@gmx.de>

	* src/parser.y (gnumeric_unsafe_expr_parser): Use the locale to
	figure out the correct separator

	* src/file.c (workbook_read): According to the GNU libc
	documentaiton retrieving the current locale should be done by
	passing NULL to setlocale as the locale argument.

1999-07-17  Michael Meeks  <michael@edenproject.org>

	* src/workbook.c (workbook_setup_edit_area): Enabled function
	wizard.

1999-07-16  Michael Meeks  <michael@edenproject.org>

	* src/summary.c (summary_item_as_text): Implemented.
	(summary_item_dump): Simplified.

	* src/xml-io.c (xml_write_summary, xml_read_summary): Created.
	(xml_workbook_read, xml_write_summary): Added summary stuff.

1999-07-17  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* doc/C/analysis-tools.sgml: Added documentation of anova, single
 	factor tool.

1999-07-14  Miguel de Icaza  <miguel@gnu.org>

	* src/fn-misc.c (gnumeric_error): Fixed usage of errors with the
	non-broken setup.

	* src/expr.c (error_message_set): Rewrote the error message logic
	to be clean and clear.  Simplified and followed the Gnumeric
	coding conventions.

1999-07-15  Michael Meeks  <michael@edenproject.org>

	* src/summary.c (summary_info_add): Add duplicate entry removal.
	Re-organised structures and enum for convenience.
	(summary_info_as_list, append_item): Created.
	(summary_item_dump): Made static.
	include stdio.h
	Add 'Category' and 'Manager'

	* src/workbook.c (summary_cmd): Create.
	Add 'Su_mmary' to file menu.

	* dialogs.h: Added summary_update.

	* src/Makefile.am (GNUMERIC_BASE_SOURCES): Add dialog-summary.c	

	* dialog-summary.c: Created.

	* summary.glade: Created.
	
1999-07-13  Jody Goldberg  <jgoldberg@home.com>

	* src/fn-lookup.c (gnumeric_lookup) : Support default args for
	  width & height.  Return cell_value directly for 1x1 results.
	(gnumeric_hyperlink) : Add stub.

	* src/expr-name.[ch] (expr_name_add, expr_name_lookup) : Const.

	* src/parser.y (make_string_return) : Handle special case of "" avoid
	  turning it into a number.

1999-07-13  Michael Meeks  <michael@edenproject.org>

	* src/Makefile.am (GNUMERIC_BASE_SOURCES): add summary.[ch]

	* src/workbook.c (workbook_core_new): Hook in summary info.
	(workbook_do_destroy): ditto.
	(deps_output): debugging hook.

	* src/sheet.h: Added SummaryInfo to Workbook.

	* src/summary.[ch]: Added.

1999-07-11  Michael Meeks  <michael@edenproject.org>

	* src/cell-draw.c (cell_draw): Added handy debug for when
	cell->text is duff.

1999-07-13  Morten Welinder  <terra@diku.dk>

	* src/fn-string.c (gnumeric_search): Actually start search where
 	advertised.
	(gnumeric_value): Try harder.

	* src/style.c (font_init): Print informative message instead of
 	just aborting.
	(style_shutdown): Remove old code.

	* src/mathfunc.h: Work around Irix incompatibility.

1999-07-13  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Implemented
 	Anova, single factor tool.

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Implemented
 	Anova, two-factor without replication tool.
	
1999-07-12  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/print-info.c (save_hf, print_hf_register): Save the headers
	and footers.  Implement registration of new formats.

	* src/dialog-printer-setup.c (do_hf_config): Added the editing
	facility to the formats.

1999-07-12  Jody Goldberg  <jgoldberg@home.com>

	* src/Gnumeric.idl : Add SplitsArray array exception for array-formula
	  support.

	* src/cell.[ch] (cell_set_border) : Const.

	* src/expr.[ch] (value_area_get_width, value_area_get_height) : Const.

	* src/fn-math.c : Added TRANSPOSE.

	* wizards/graphics/*.c : Minor text tweaks so that things come closer
	  to compiling.

1999-07-12  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* doc/C/analysis-tools.sgml: Small fixes and additions.
	
	* src/dialog-analysis-tools.c, src/analysis-tools.c: Added
 	Bernoulli distribution to the Random Number Generation tool.

	* src/analysis-tools.c: Finished Rank and Percentile tool.
	
	* src/analysis-tools.c: Fixed ``F/z/t Critical'' values of the
 	F-Test, t-Test, and z-Test Tools.
	
1999-07-12  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Made ``Labels
 	in the first row'' option to actually work.  Killed some warnings
 	and bugs related to outputs too.

1999-07-12  Miguel de Icaza  <miguel@gnu.org>

	* src/cell.c (cell_set_font): Now takes a "points" argument.

	* src/Gnumeric.idl (Sheet): Take a double for the cell_set_font
	points parameter.

1999-07-11  Raja R Harinath  <harinath@cs.umn.edu>

	* configure.in: Don't use `foo >& /dev/null' style redirection, 
	use `foo > /dev/null 2>&1'.

1999-07-11  Miguel de Icaza  <miguel@gnu.org>

	* src/dialog-cell-format.c (apply_font_format): Use the
	FontSelector here. 

	* src/widget-font-selector.c (reload_preview): New approach for
	font loading, by using the scale explicitly I got it to work ;-).
	(font_selector_choose): New routine to set the font style.

	* src/sheet.c (sheet_init_default_styles): Change of plans, we are
	going to use 80 units for the default width.

	* src/widget-font-selector.c: New file.  A simplified and robust
	font selector for Gnumeric.
	(fs_fill_font_name_list): Free this.

1999-07-11  Jody Goldberg  <jgoldberg@home.com>

	* src/item-grid.c (context_cut_cmd, context_copy_cmd context_paste_cmd,
	    context_paste_special_cmd, context_insert_cmd, context_delete_cmd,
	    context_clear_cmd, context_cell_format_cmd, create_popup_menu,
	    item_grid_popup_menu) : Operate on Sheet* rather than ItemGrid*.

	* src/item-bar.c (item_bar_event) : Popup an item_grid_popup_menu
	  when Button3 is pressed.  Excel also adds an entry to change
	  col widths/row heights,  that will be next TODO.

	* src/dialog-insert-cells.c, src/dialog-delete-cells.c :
	  Short circuit the menus when an entire row/column is selected.  This
	  fixes the problem of selecting a column and accidentaly inserting a
	  row would clear the sheet inserting MAX_ROW rows and erasing
	  everything ...

	* src/cell-draw.c (cell_draw) : Remove use of str_trim_spaces and
	  correct the bounding rectangle size for multiline entries.
	(cell_split_text) : Rework logic to strip spaces when a forced split
	  causes a linebreak @ those spaces.  Plus more comments.

	* src/print-cell.c (cell_split_text, print_cell_text) : Ditto.
	  Switch accumulators to doubles.

	* src/parser.y : Moved dump_value from here.
	* src/expr.c : to here.  And changed the format of CellRanges
	  to be more appealing.

	* src/cell.c (cell_relocate) : Add some cruft to handle relinking
	  the corner cell of an array formula.

	* src/clipboard.c (clipboard_prepend_cell) : Renamed from
	  clipboard_append_cell.  So that there is truth in naming.
	(clipboard_copy_cell_range) : Reverse the result of
	  clipboard_prepend_cell so that the upper left corner is 1st.

	(Sheet *sheet, int col, int row, Cell *cell, void *user_data)
	* src/expr.c (eval_range) : New function to ensure that range
	  arguments are recalculated.
	 (eval_expr) : Use it.

	* src/sheet.c (range_check_for_partial_array) : New function.  To avoid
	  subdividing arrays does some obvious optimizations.
	(sheet_fill_selection_with) : Split out from here.
	(sheet_delete_col, sheet_delete_row) : Used here too.

1999-07-11  Michael Meeks  <michael@edenproject.org>

	* Sort ChangeLog out, apologies.

1999-07-10  Michael Meeks  <michael@edenproject.org>

	* src/func.c (function_iterate_do_value): Clean to use new
	macro.

	* src/fn-stat.c (gnumeric_rank, gnumeric_prob, gnumeric_steyx),
	(gnumeric_ftest, gnumeric_slope, gnumeric_percentrank),
	(gnumeric_ttest, gnumeric_forecast, gnumeric_intercept): New
	sheet support.

	* src/fn-math.c (gnumeric_countif): Cleaned with nicer sheet
	select macro.
	(gnumeric_sumif, gnumeric_sumx2my2, gnumeric_sumxmy2),
	(validate_range_numeric_matrix): Added new sheet support.
	
	* src/fn-information.c (gnumeric_countblank): Added correct
	sheet support.

	* src/fn-database.c (find_column_of_field): Add EvalPosition
	to get valid Sheet * from & use it.
	(parse_database_criteria, find_cells_that_match): Ditto.
	Update all references.

	* src/expr.c (value_area_get_height): Use eval_sheet
	(eval_funcall): Remove redundant Sheet * setting.

	* src/expr.h: Add eval_sheet to help all over the place.

	* src/eval.c (add_cell_range_deps): Use eval_sheet, and make
	warning more correct.
