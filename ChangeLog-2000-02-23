1999-07-30  James Youngman  <jay@gnu.org>

	* src/fn-eng.c (gnumeric_besseli): Implemented.
	(gnumeric_besselk): Implemented.
	(eng_functions_init): Add relevant inits.
	Include mathfunc.h

1999-07-30  Morten Welinder  <terra@diku.dk>

	* src/cell.c (cell_cleanout): New function.
	(cell_set_formula): Don't bother with CELL_ERROR.  Set value field
 	in all cases.
	(cell_set_array_formula): Set cell values.
	(cell_set_value_simple): Simplify using cell_cleanout.
	(cell_set_text_simple): Ditto.
	(cell_set_formula_tree_simple): Ditto.
	(cell_destroy): Ditto.
	(cell_get_text): Simplify.
	(cell_get_content): Ditto.

	* src/eval.c (cell_eval): Reorganise slightly.

	* src/expr.c (eval_expr_real): value should no longer be null.

	* src/cell.h (CELL_ERROR): Obsolete.

	* src/print-info.h (hf_formats): Make extern.

	* src/summary.h (summary_item_name): Make extern.

1999-07-29  Michael Meeks  <michael@edenproject.org>

	* src/cell.c (cell_set_text_simple): Chomp whitespace off the
	end of integers ( other spreadsheets do this ).

1999-07-28  Michael Meeks  <michael@edenproject.org>

	* src/summary.c: Update, was out of step with the header.

1999-07-28  Michael Meeks  <michael@edenproject.org>

	* src/item-grid.h: Added border_gc[BORDER_MAX] to ItemGrid.

	* src/item-grid.c (item_grid_draw_cell): Border rendering code.
	Make rendering conditional on debug - this looks awful.
	(item_grid_realize): ditto + struct of types in style_border_data.
	(item_grid_unrealize): clean up after myself.

1999-07-27  Jody Goldberg  <jgoldberg@home.com>

	* src/fn-date.c : Add EOMONTH, and partial WORKDAY.

	* src/formats.c : Add more date formats.

	* src/fn-math.c (gnumeric_transpose) : no need for an array
          if the input is a singleton.

	* src/expr.c : Add comment explaining the need for a re-org
          to correctly handle implicit intersetion vs arrays with
          operators.  Move all value_* functions into.

	* src/value.c : Here.

	* src/func.c : Move const value initialization into value.c.

	* src/clipboard.c (clipboard_prepend_cell) : Return Value * as per
          change to VALUE_ERROR.

	* src/style.h : Add STYLE_ORIENT_MAX to remove ugly magic number
          that will change when we add support for diagonals.

	* src/print-cell.c (print_cell_border, print_border) : Use enum
	  rather than hard coding the number of border types.

	* TODO : Add implicit intersection for operators.

1999-07-25  Jody Goldberg  <jgoldberg@home.com>

	* plugins/guile/plugin.c,
	  plugins/python/python.c
	  src/{Makefile.am, cell.[ch], collect.[ch], eval.c, expr-name.c,
	       expr.[ch], fn-database.c, fn-date.c, fn-eng.c, fn-financial.c,
	       fn-information.c, fn-logical.c, fn-lookup.c, fn-math.c,
	       fn-misc.c, fn-sheet.c, fn-stat.c, fn-string.c, format.c,
	       func.[ch], sheet-object-container.c, sheet.[ch]}
	  : Add VALUE_ERROR, VALUE_BOOLEAN, Change many signatures to return
	    Value for errors.

	* icons/chart_*.png : Add Some images in preparation for re-enabling
	  the graph wizard.

	* src/expr.c (eval_funcall) : When a single row or column is passed to
	  a function expecting a single value, take the intersection of the
	  evaluation position and the range.
	(cell_ref_get_abs_col, cell_ref_get_abs_row) : New functions.

	* src/value.[ch] : New files with Value support routines split out from
	  expr.[ch]

1999-07-26  Michael Meeks  <michael@edenproject.org>

	* src/corba-sheet.c (fill_corba_value): Remove redundant Sheet *
	from cellref_name.

1999-07-26  Michael Meeks  <michael@edenproject.org>

	* src/xml-io.c (xml_read_cell): Commented out freeze/thaw deps.

	* src/cell.c (cell_deep_freeze_dependencies): Added warning not to
	use: strangely it doesn't work... investigate later.

1999-07-25  Michael Meeks  <michael@edenproject.org>

	* src/xml-io.c (xml_read_cell): Add freeze/thaw dependencies,
	and fix exit condition to restore state to correct coolness.

	* src/cell.h: Added prototypes.

	* src/cell.c (cell_content_changed, cell_formula_changed): 
	(cell_deep_thaw_dependencies, cell_deep_freeze_dependencies): 
	Added optimisation for load/save stuff.

1999-07-25  Michael Meeks  <michael@edenproject.org>

	* src/xml-io.c (xml_read_summary): Fix some massive cock-ups, how
	did this ever work.
	(xml_read_names): ditto.
	(xml_workbook_read): Shifted read_names down to where we actualy
	have the inter-sheet reference names in place.

	* src/expr.c (expr_tree_invalidate_references): Debugging that
	needs cleaning to new PP stuff #if-def'd out.
	(expr_tree_fixup_references): ditto.

	* src/xml-io.c (xml_write_names, xml_read_names): Implemented
	(xml_workbook_write, xml_workbook_read): Hooks added, but reading
	disabled: something dodgy somewhere.

	* src/sheet.c (sheet_lookup_by_name): Fixed to use simply a
	Workbook pointer.

	* src/workbook.c (workbook_set_auto_expr): Fix old hack using
	new PP stuff.

	* src/sheet.c (sheet_fill_selection_with): Updated to new PP code.

	* src/parser.y (gnumeric_expr_parser): Updated to new PP code,
	removed redundant and nasty _unsafe_expr_parser hack. Essentialy
	nothing new, but removes daft parser_sheet and replaces with
	parser_workbook, leaving sheet stuff to the evaluation stage.

	* src/dialog-define-names.c: Major fixups, killed obscure bug
	cause by freeing a copy of a list I passed to gtk_list_append_items.

	* src/expr.c (expr_parse_string, do_expr_decode_tree): 
	(expr_decode_tree): Updated to new 

	* src/expr-name.c (expr_name_create): Added for convenience.
	(expr_name_value): Updated to new PP scheme

	* src/cell.c (cell_set_formula, cell_get_text, cell_get_content): 
	Update to new ParsePosition scheme.

	* src/expr.c (parse_pos_init, parse_pos_cell): Created.

	* src/expr.h: Add ParsePosition & prototpes

1999-07-25  Michael Meeks  <michael@edenproject.org>

	* src/dialog-define-names.c (update_edit): use expr_name_value.
	(grab_text_ok): Update to use new functions.

	* src/expr-name.c (expr_name_value): Added.
	(expr_name_create): Convenience function

	* src/xml-io.c (xml_workbook_write): Added names writing.

1999-07-24  Michael Meeks  <michael@edenproject.org>

	* src/expr-name.c (expr_name_add): Add check for circular
	references in (name_refer_circular): created.
	(add_real): More paranoia.

1999-07-23  Michael Meeks  <michael@edenproject.org>

	* src/expr-name.c (expr_name_list): Expand.
	(expr_name_remove): Serious bug freeing names.
	(expr_name_lookup): precondition.
	(expr_name_remove): more sanity checks.

	* src/dialog-define-names.c (fill_list): Append instead of inserting
	items. use "select" signal, hand the correct pointer on.
	Implemented guts, fixed lots of bugs.
	
1999-07-25  Karsten Weiss  <karsten@addx.au.s.shuttle.de>

	* src/print.glade.h: Fixed three typos.
	* src/hf-config.glade.h: Fixed a typo.
	Is this the right place to fix the typos or are they auto-generated
	from some other source?
	
1999-07-21  Miguel de Icaza  <miguel@gnu.org>

	* src/dialog-printer-setup.c (preview_page_destroy): Clear the
	pointers after unrefing.

	* src/print.c (setup_rotation): Add the rotation code for the
	vertical/horizontal printing.

1999-07-22  Michael Meeks  <michael@edenproject.org>

	* src/dialog-define-names.c (dialog_define_names): Removed all the
	dead code.
	Lots of new code ... not there yet though.
	
	* src/workbook.c: Enabled names menu item.

	* src/dialog-summary.c: add file header.

	* src/Makefile.am (glade_DATA): Added summary.glade and names.glade
	seems I didn't do this earlier: odd.

	* names.glade: Created.
	
1999-07-22  Michael Meeks  <michael@edenproject.org>

	* src/expr-name.c: Stylistic precondition fixes,
	simplification & workbook integration.

	* src/workbook.c (workbook_core_new): init names.
	(workbook_do_destroy): add name clean.

	* src/sheet.h: Add Workbook->names.

	* src/func.h: Added comments moved from expr.h

1999-07-21  Richard Hestilow  <hestgray@ionet.net>
	
	* gnumeric.gnorba: Fix "Embeddable" typo 
	(was IDL:/GNOME/Embeddable, should have been IDL:GNOME/Embeddable)

1999-07-21  Michael Meeks  <michael@edenproject.org>

	* src/widget-font-selector.c (fs_init): Convert g_error to
	g_warning on missing glade_xml_new.

	* src/Makefile.am (GNUMERIC_CORBA_GENERATED): Make this empty
	if BONOBO is not installed, should kill peoples Gnumeric.idl
	problems with luck.

	* configure.in: Add lotus-123

	* plugins/Makefile.am: ditto.

	* src/main.c: Remove xbase include.

1999-07-20  Jody Goldberg  <jgoldberg@home.com>

	* src/expr.c (value_area_fetch_x_y) : make value_zero local.
	(eval_expr) : renamed eval_expr_real, and allowed it to return NULL
	  in all the places that make sense.
	(eval_expr) : New function.  Calls eval_expr_real and returns 0 on
	  NULL with no error set.  Until VALUE_ERROR is in place things
	  will look funny.

1999-07-20  Miguel de Icaza  <miguel@gnu.org>

	* src/item-bar.c (bar_draw_cell): Move the dimension computaiton
	of the font after we have figured which font to use.  Before we
	did all the computaiton based on the default font, which is not
	always the font used (we use bold font for selected rows).

	This fixes the bug Morten reported.

1999-07-20  Jody Goldberg  <jgoldberg@home.com>

	* src/fn-math.c : Moved gpow10 from here.
	* src/utils.[ch] : to here.

	* src/expr.c (value_area_get_x_y) : return NULL in all cases of
	  invalid refernces dont fake a 0.
	Rename TYPE_ERROR -> TYPE_MISMATCH.
	(is_null_string) : New function.
	(compare) : Allow equality tests between empty/error things too.
	(eval_expr) : Allow comparisons of empty/error values.  It can handle
	  it now.
	(OPER_ARRAY) : Use value_area_get_x_y not fetch_x_y, handle empty/error.
	(value_get_as_string) : Fix typo in recent unlogged change.  The change
	  might break importing files from a different locale.

	* src/fn-string.c : Add TEXT, improve VALUE, REPLACE so that they
	  passes more tests.

	* src/number-match.c (compute_value) : Partial support for thousands
	  separator.  Why doesn't this code use locale ?

	* src/format.c (format_value) : better support for ranges, attempt to
	  work around problem of a thousands seperator in a date format.

	* src/cell-draw.c (cell_draw) : Fix potential for infinite loop
	  with HALIGN_FILL.
	* src/print-cell.c (print_cell_text) : Ditto.

	* src/parser.y (make_string_return) : A string of the form "..." is
	  a string, don't try to parse it as a number.

	* src/pattern-selector.[ch] : pattern_selector_select made static. In
	  preparation for different approach.

1999-07-19  Andreas Voegele <andreas.voegele@gmx.de>

	* src/parser.y (gnumeric_unsafe_expr_parser): Use the locale to
	figure out the correct separator

	* src/file.c (workbook_read): According to the GNU libc
	documentaiton retrieving the current locale should be done by
	passing NULL to setlocale as the locale argument.

1999-07-17  Michael Meeks  <michael@edenproject.org>

	* src/workbook.c (workbook_setup_edit_area): Enabled function
	wizard.

1999-07-16  Michael Meeks  <michael@edenproject.org>

	* src/summary.c (summary_item_as_text): Implemented.
	(summary_item_dump): Simplified.

	* src/xml-io.c (xml_write_summary, xml_read_summary): Created.
	(xml_workbook_read, xml_write_summary): Added summary stuff.

1999-07-17  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* doc/C/analysis-tools.sgml: Added documentation of anova, single
 	factor tool.

1999-07-14  Miguel de Icaza  <miguel@gnu.org>

	* src/fn-misc.c (gnumeric_error): Fixed usage of errors with the
	non-broken setup.

	* src/expr.c (error_message_set): Rewrote the error message logic
	to be clean and clear.  Simplified and followed the Gnumeric
	coding conventions.

1999-07-15  Michael Meeks  <michael@edenproject.org>

	* src/summary.c (summary_info_add): Add duplicate entry removal.
	Re-organised structures and enum for convenience.
	(summary_info_as_list, append_item): Created.
	(summary_item_dump): Made static.
	include stdio.h
	Add 'Category' and 'Manager'

	* src/workbook.c (summary_cmd): Create.
	Add 'Su_mmary' to file menu.

	* dialogs.h: Added summary_update.

	* src/Makefile.am (GNUMERIC_BASE_SOURCES): Add dialog-summary.c	

	* dialog-summary.c: Created.

	* summary.glade: Created.
	
1999-07-13  Jody Goldberg  <jgoldberg@home.com>

	* src/fn-lookup.c (gnumeric_lookup) : Support default args for
	  width & height.  Return cell_value directly for 1x1 results.
	(gnumeric_hyperlink) : Add stub.

	* src/expr-name.[ch] (expr_name_add, expr_name_lookup) : Const.

	* src/parser.y (make_string_return) : Handle special case of "" avoid
	  turning it into a number.

1999-07-13  Michael Meeks  <michael@edenproject.org>

	* src/Makefile.am (GNUMERIC_BASE_SOURCES): add summary.[ch]

	* src/workbook.c (workbook_core_new): Hook in summary info.
	(workbook_do_destroy): ditto.
	(deps_output): debugging hook.

	* src/sheet.h: Added SummaryInfo to Workbook.

	* src/summary.[ch]: Added.

1999-07-11  Michael Meeks  <michael@edenproject.org>

	* src/cell-draw.c (cell_draw): Added handy debug for when
	cell->text is duff.

1999-07-13  Morten Welinder  <terra@diku.dk>

	* src/fn-string.c (gnumeric_search): Actually start search where
 	advertised.
	(gnumeric_value): Try harder.

	* src/style.c (font_init): Print informative message instead of
 	just aborting.
	(style_shutdown): Remove old code.

	* src/mathfunc.h: Work around Irix incompatibility.

1999-07-13  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Implemented
 	Anova, single factor tool.

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Implemented
 	Anova, two-factor without replication tool.
	
1999-07-12  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/print-info.c (save_hf, print_hf_register): Save the headers
	and footers.  Implement registration of new formats.

	* src/dialog-printer-setup.c (do_hf_config): Added the editing
	facility to the formats.

1999-07-12  Jody Goldberg  <jgoldberg@home.com>

	* src/Gnumeric.idl : Add SplitsArray array exception for array-formula
	  support.

	* src/cell.[ch] (cell_set_border) : Const.

	* src/expr.[ch] (value_area_get_width, value_area_get_height) : Const.

	* src/fn-math.c : Added TRANSPOSE.

	* wizards/graphics/*.c : Minor text tweaks so that things come closer
	  to compiling.

1999-07-12  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* doc/C/analysis-tools.sgml: Small fixes and additions.
	
	* src/dialog-analysis-tools.c, src/analysis-tools.c: Added
 	Bernoulli distribution to the Random Number Generation tool.

	* src/analysis-tools.c: Finished Rank and Percentile tool.
	
	* src/analysis-tools.c: Fixed ``F/z/t Critical'' values of the
 	F-Test, t-Test, and z-Test Tools.
	
1999-07-12  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Made ``Labels
 	in the first row'' option to actually work.  Killed some warnings
 	and bugs related to outputs too.

1999-07-12  Miguel de Icaza  <miguel@gnu.org>

	* src/cell.c (cell_set_font): Now takes a "points" argument.

	* src/Gnumeric.idl (Sheet): Take a double for the cell_set_font
	points parameter.

1999-07-11  Raja R Harinath  <harinath@cs.umn.edu>

	* configure.in: Don't use `foo >& /dev/null' style redirection, 
	use `foo > /dev/null 2>&1'.

1999-07-11  Miguel de Icaza  <miguel@gnu.org>

	* src/dialog-cell-format.c (apply_font_format): Use the
	FontSelector here. 

	* src/widget-font-selector.c (reload_preview): New approach for
	font loading, by using the scale explicitly I got it to work ;-).
	(font_selector_choose): New routine to set the font style.

	* src/sheet.c (sheet_init_default_styles): Change of plans, we are
	going to use 80 units for the default width.

	* src/widget-font-selector.c: New file.  A simplified and robust
	font selector for Gnumeric.
	(fs_fill_font_name_list): Free this.

1999-07-11  Jody Goldberg  <jgoldberg@home.com>

	* src/item-grid.c (context_cut_cmd, context_copy_cmd context_paste_cmd,
	    context_paste_special_cmd, context_insert_cmd, context_delete_cmd,
	    context_clear_cmd, context_cell_format_cmd, create_popup_menu,
	    item_grid_popup_menu) : Operate on Sheet* rather than ItemGrid*.

	* src/item-bar.c (item_bar_event) : Popup an item_grid_popup_menu
	  when Button3 is pressed.  Excel also adds an entry to change
	  col widths/row heights,  that will be next TODO.

	* src/dialog-insert-cells.c, src/dialog-delete-cells.c :
	  Short circuit the menus when an entire row/column is selected.  This
	  fixes the problem of selecting a column and accidentaly inserting a
	  row would clear the sheet inserting MAX_ROW rows and erasing
	  everything ...

	* src/cell-draw.c (cell_draw) : Remove use of str_trim_spaces and
	  correct the bounding rectangle size for multiline entries.
	(cell_split_text) : Rework logic to strip spaces when a forced split
	  causes a linebreak @ those spaces.  Plus more comments.

	* src/print-cell.c (cell_split_text, print_cell_text) : Ditto.
	  Switch accumulators to doubles.

	* src/parser.y : Moved dump_value from here.
	* src/expr.c : to here.  And changed the format of CellRanges
	  to be more appealing.

	* src/cell.c (cell_relocate) : Add some cruft to handle relinking
	  the corner cell of an array formula.

	* src/clipboard.c (clipboard_prepend_cell) : Renamed from
	  clipboard_append_cell.  So that there is truth in naming.
	(clipboard_copy_cell_range) : Reverse the result of
	  clipboard_prepend_cell so that the upper left corner is 1st.

	(Sheet *sheet, int col, int row, Cell *cell, void *user_data)
	* src/expr.c (eval_range) : New function to ensure that range
	  arguments are recalculated.
	 (eval_expr) : Use it.

	* src/sheet.c (range_check_for_partial_array) : New function.  To avoid
	  subdividing arrays does some obvious optimizations.
	(sheet_fill_selection_with) : Split out from here.
	(sheet_delete_col, sheet_delete_row) : Used here too.

1999-07-11  Michael Meeks  <michael@edenproject.org>

	* Sort ChangeLog out, apologies.

1999-07-10  Michael Meeks  <michael@edenproject.org>

	* src/func.c (function_iterate_do_value): Clean to use new
	macro.

	* src/fn-stat.c (gnumeric_rank, gnumeric_prob, gnumeric_steyx),
	(gnumeric_ftest, gnumeric_slope, gnumeric_percentrank),
	(gnumeric_ttest, gnumeric_forecast, gnumeric_intercept): New
	sheet support.

	* src/fn-math.c (gnumeric_countif): Cleaned with nicer sheet
	select macro.
	(gnumeric_sumif, gnumeric_sumx2my2, gnumeric_sumxmy2),
	(validate_range_numeric_matrix): Added new sheet support.
	
	* src/fn-information.c (gnumeric_countblank): Added correct
	sheet support.

	* src/fn-database.c (find_column_of_field): Add EvalPosition
	to get valid Sheet * from & use it.
	(parse_database_criteria, find_cells_that_match): Ditto.
	Update all references.

	* src/expr.c (value_area_get_height): Use eval_sheet
	(eval_funcall): Remove redundant Sheet * setting.

	* src/expr.h: Add eval_sheet to help all over the place.

	* src/eval.c (add_cell_range_deps): Use eval_sheet, and make
	warning more correct.
