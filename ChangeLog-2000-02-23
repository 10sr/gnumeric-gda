1999-07-13  Morten Welinder  <terra@diku.dk>

	* src/style.c (font_init): Print informative message instead of
 	just aborting.
	(style_shutdown): Remove old code.

	* src/mathfunc.h: Work around Irix incompatibility.

1999-07-13  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Implemented
 	Anova, single factor tool.

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Implemented
 	Anova, two-factor without replication tool.
	
1999-07-12  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/print-info.c (save_hf, print_hf_register): Save the headers
	and footers.  Implement registration of new formats.

	* src/dialog-printer-setup.c (do_hf_config): Added the editing
	facility to the formats.

1999-07-12  Jody Goldberg  <jgoldberg@home.com>

	* src/Gnumeric.idl : Add SplitsArray array exception for array-formula
	  support.

	* src/cell.[ch] (cell_set_border) : Const.

	* src/expr.[ch] (value_area_get_width, value_area_get_height) : Const.

	* src/fn-math.c : Added TRANSPOSE.

	* wizards/graphics/*.c : Minor text tweaks so that things come closer
	  to compiling.

1999-07-12  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* doc/C/analysis-tools.sgml: Small fixes and additions.
	
	* src/dialog-analysis-tools.c, src/analysis-tools.c: Added
 	Bernoulli distribution to the Random Number Generation tool.

	* src/analysis-tools.c: Finished Rank and Percentile tool.
	
	* src/analysis-tools.c: Fixed ``F/z/t Critical'' values of the
 	F-Test, t-Test, and z-Test Tools.
	
1999-07-12  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/dialog-analysis-tools.c, src/analysis-tools.c: Made ``Labels
 	in the first row'' option to actually work.  Killed some warnings
 	and bugs related to outputs too.

1999-07-12  Miguel de Icaza  <miguel@gnu.org>

	* src/cell.c (cell_set_font): Now takes a "points" argument.

	* src/Gnumeric.idl (Sheet): Take a double for the cell_set_font
	points parameter.

1999-07-11  Raja R Harinath  <harinath@cs.umn.edu>

	* configure.in: Don't use `foo >& /dev/null' style redirection, 
	use `foo > /dev/null 2>&1'.

1999-07-11  Miguel de Icaza  <miguel@gnu.org>

	* src/dialog-cell-format.c (apply_font_format): Use the
	FontSelector here. 

	* src/widget-font-selector.c (reload_preview): New approach for
	font loading, by using the scale explicitly I got it to work ;-).
	(font_selector_choose): New routine to set the font style.

	* src/sheet.c (sheet_init_default_styles): Change of plans, we are
	going to use 80 units for the default width.

	* src/widget-font-selector.c: New file.  A simplified and robust
	font selector for Gnumeric.
	(fs_fill_font_name_list): Free this.

1999-07-11  Jody Goldberg  <jgoldberg@home.com>

	* src/item-grid.c (context_cut_cmd, context_copy_cmd context_paste_cmd,
	    context_paste_special_cmd, context_insert_cmd, context_delete_cmd,
	    context_clear_cmd, context_cell_format_cmd, create_popup_menu,
	    item_grid_popup_menu) : Operate on Sheet* rather than ItemGrid*.

	* src/item-bar.c (item_bar_event) : Popup an item_grid_popup_menu
	  when Button3 is pressed.  Excel also adds an entry to change
	  col widths/row heights,  that will be next TODO.

	* src/dialog-insert-cells.c, src/dialog-delete-cells.c :
	  Short circuit the menus when an entire row/column is selected.  This
	  fixes the problem of selecting a column and accidentaly inserting a
	  row would clear the sheet inserting MAX_ROW rows and erasing
	  everything ...

	* src/cell-draw.c (cell_draw) : Remove use of str_trim_spaces and
	  correct the bounding rectangle size for multiline entries.
	(cell_split_text) : Rework logic to strip spaces when a forced split
	  causes a linebreak @ those spaces.  Plus more comments.

	* src/print-cell.c (cell_split_text, print_cell_text) : Ditto.
	  Switch accumulators to doubles.

	* src/parser.y : Moved dump_value from here.
	* src/expr.c : to here.  And changed the format of CellRanges
	  to be more appealing.

	* src/cell.c (cell_relocate) : Add some cruft to handle relinking
	  the corner cell of an array formula.

	* src/clipboard.c (clipboard_prepend_cell) : Renamed from
	  clipboard_append_cell.  So that there is truth in naming.
	(clipboard_copy_cell_range) : Reverse the result of
	  clipboard_prepend_cell so that the upper left corner is 1st.

	(Sheet *sheet, int col, int row, Cell *cell, void *user_data)
	* src/expr.c (eval_range) : New function to ensure that range
	  arguments are recalculated.
	 (eval_expr) : Use it.

	* src/sheet.c (range_check_for_partial_array) : New function.  To avoid
	  subdividing arrays does some obvious optimizations.
	(sheet_fill_selection_with) : Split out from here.
	(sheet_delete_col, sheet_delete_row) : Used here too.

1999-07-11  Michael Meeks  <michael@edenproject.org>

	* Sort ChangeLog out, apologies.

1999-07-10  Michael Meeks  <michael@edenproject.org>

	* src/func.c (function_iterate_do_value): Clean to use new
	macro.

	* src/fn-stat.c (gnumeric_rank, gnumeric_prob, gnumeric_steyx),
	(gnumeric_ftest, gnumeric_slope, gnumeric_percentrank),
	(gnumeric_ttest, gnumeric_forecast, gnumeric_intercept): New
	sheet support.

	* src/fn-math.c (gnumeric_countif): Cleaned with nicer sheet
	select macro.
	(gnumeric_sumif, gnumeric_sumx2my2, gnumeric_sumxmy2),
	(validate_range_numeric_matrix): Added new sheet support.
	
	* src/fn-information.c (gnumeric_countblank): Added correct
	sheet support.

	* src/fn-database.c (find_column_of_field): Add EvalPosition
	to get valid Sheet * from & use it.
	(parse_database_criteria, find_cells_that_match): Ditto.
	Update all references.

	* src/expr.c (value_area_get_height): Use eval_sheet
	(eval_funcall): Remove redundant Sheet * setting.

	* src/expr.h: Add eval_sheet to help all over the place.

	* src/eval.c (add_cell_range_deps): Use eval_sheet, and make
	warning more correct.
