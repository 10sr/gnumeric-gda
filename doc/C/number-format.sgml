<sect1 id="cell-formatting">
  <title>Cell Formatting</title>

  <para>Cell formats allow you to change the way cell data appears in
    the spreadsheet. It is important to keep in mind that it only
    alters the way the data is presented, and does not change the
    value of the data. </para>
  
  <para>The formatting options allows for monetary units, scientific
     options, dates, times, fractions,and more. Positive and negative
     values can have different colors and formats for aiding in
     keeping track of values. There are also a large variety of date
     and time formats for virtually any time and date format one can
     think of.
    </para>
    
  <para>To change the formatting style for a cell or a range of cells,
    you only need to select the range of cells (see <xref
    linkend="editing-selections">) where you want to apply/change the
    format and then select from the
    <guimenu>Format</guimenu>/<guimenuitem>Cells</guimenuitem>/Numbers
    menu (or from the context sensitive popup menu bound to the right
    mouse button) the appropriate format.</para>
  
  <para>The quickest way to access the cell format dialog is to use
        its keyboard shortcut,
        <keycombo><keycap>Ctrl</keycap><keycap>1</keycap></keycombo>.
        This is equivalent to selecting the cell format item from the
        menus.</para>

  <para>Gnumeric provides a wide range of predetermined formatting
    styles.  These formatting styles are shown by category in the
    Cell/Style dialog box.  Just choose one of the display formats and
    accept the changes to change the display format for your
    cells.</para>
  
  <para>If none of the predetermined formatting styles fits your
    needs, you can define your own number formatting style by using a
    custom formatting expression: the custom formatting expressions
    give you more flexibility in number display.</para>

<sect2 id="format-dialog">
  <title>The Format Dialog</title>

  <para>The number formatting dialog (see <xref linkend="number-format-dialog"> ) 
      provides a wide range of options for 
    formatting numbers. The primary use of the dialog is to select from
      one of the many preset number formatting rules. These formatting styles
      should be more than adequate for the vast majority of cases. If none
      of these meet the needs of the user, it is possible to create your own
      formats. </para>
  
  <figure id="number-format-dialog">
      <title>The main number formatting dialog.</title>
      <screenshot>
	<graphic fileref="figures/number-format-dialog.png" format="png"></graphic>
      </screenshot>
    </figure>
    
  <para>The page is split into two sections, a set of formatting
  categories, and some convenience tools for manipulating the formats
  in each category.</para>

  <para>There is also a Sample output of what the new formatting looks like.
  </para>
</sect2>    


<sect2 id="changing-font">
<title>Changing the Font or Font Color</title>

<para>Any cell can use any font that is availble to Gnumeric. This 
includes font attributes like bold, italics, etc as well as
font size.</para>

<para>To change the font for cells, simply open the file format
dialog (see <xref linkend="format-dialog">), and select the font
tab. This will open the standard Gnome font selection dialog.</para>


<figure id="number-format-font-dialog">
   <title>The Font selection dialog</title>
   <screenshot>
      <graphic fileref="figures/number-format-font-dialog.png" format="png"></graphic>
   </screenshot>
</figure>


<procedure>
  <title>To change a cells font</title>
   <step>
     <para>
        Select the cell or range of cell that the font needs to be changed in. </para>
   </step>
   <step>
      <para>Open the cell format dialog. This dialog can be opened from the
         <guimenu>Format</guimenu><guimenuitem>Cells</guimenuitem> menu,
         with the <keycombo><keycap>Ctrl</keycap><keycap>1</keycap></keycombo>,
         or from right-clicking (<mousebutton>MB3</mousebutton>) and choosing
         the <guimenuitem>Cell Format</guimenuitem> menu option.</para>
   </step>
   <step>
      <para>Select the font tab in the dialog box notebook. This will open
            the font selection part of the dialog. See
            <xref linkend="number-format-font-dialog"> for a look at
            the dialog.</para>
</step>
   <step><para>Select your font and the font properties and click <guibutton>OK</guibutton>.</para></step>

</procedure>

<para>For simply changing a cell's format to be Bold or Italics,
there are buttons on the toolbar for doing this quickly.
See <xref linkend="number-format-bold-italics"></para>

<procedure>
  <title>Changing a cell's text color</title>
 <step>
     <para>
        Select the cell or range of cell that the color needs to be changed in. </para>
   </step>
    <step>
      <para>Open the cell format dialog. This dialog can be opened from the
         <guimenu>Format</guimenu><guimenuitem>Cells</guimenuitem> menu,
         with the <keycombo><keycap>Ctrl</keycap><keycap>1</keycap></keycombo>,
         or from right-clicking (<mousebutton>MB3</mousebutton>) and choosing
         the <guimenuitem>Cell Format</guimenuitem> menu option.</para>
   </step>
   <step>
       <para>Select the <guilabel>Font </guilabel> tab in the dialog box notebook. This will open
       the font selection part of the dialog. See 
       <xref linkend="number-format-color-dialog"> for a look at the dialog.</para>
   </step>
   <step><para>Select your color and click <guibutton>OK</guibutton>.</para></step>

</procedure>

</sect2>

<sect2 id="chainging-cell-background-color-and-patterns">
<title>Changing the cell's Background Colors and Patterns</title>

<para>A cell in gnumeric can be assigned a solid background color, and an
pattern with a potentially different color.
</para>

<figure id="number-format-color-dialog">
  <title>The cell color dialog.</title>
    <screenshot>
      <graphic fileref="figures/number-format-color-dialog.png" format="png"></graphic>
     </screenshot>
</figure>

<para>The <guilabel>background configuration</guilabel> includes
options for setting the cells background to either a solid
color or a pattern.</para>

<para>To set the background of the cell to a solid color,
click on the <guibutton>use solid color</guibutton>, and
choose a color from the color selector dialog. </para>

<para>To set a pattern for the cell background, 
click on the <guibutton>use a pattern</guibutton> button
and select a pattern by clicking on the pattern the user wants.
There is a solid black border that should outline the currently
selected pattern. </para>

</sect2>

<sect2 id="cell-content-justification-and-alignment">
<title>Cell content justification and alignment</title>

  
<para>The contents of a cell can be justified and aligned
as needed. There are several justification options. See
<xref linkend="number-format-justification">.</para>

<figure id="number-format-justification">
  <title>Example of text justification.</title>
  <screenshot>
     <graphic fileref="figures/number-format-justification.png" format="png"></graphic>
   </screenshot>
</figure>

<figure id="number-format-justification-dialog">
  <title>The cell justification dialog.</title>
  <screenshot>
     <graphic fileref="figures/number-format-justification-dialog-2.png" format="png"></graphic>
   </screenshot>
</figure>

<procedure>
 <title>Changing a cells justification.</title>
   <step>
    <para>
        Select the cell or range of cell that the justification needs to be changed in. </para>
   </step>
    <step>
      <para>Open the cell format dialog. This dialog can be opened from the
         <guimenu>Format</guimenu><guimenuitem>Cells</guimenuitem> menu,
         with the <keycombo><keycap>Ctrl</keycap><keycap>1</keycap></keycombo>,
         or from right-clicking (<mousebutton>MB3</mousebutton>) and choosing
         the <guimenuitem>Cell Format</guimenuitem> menu option.</para>
   </step>
   <step>
     <para>
       Select the <guilabel>Alignment</guilabel> tab from the notebook tabs. This
       will open the font selection part of the dialog. See
       <xref linkend="number-format-justification-dialog"> for a look at the dialog.
     </para>
    </step>
   <step>
     <para>Choose a horizontal and vertical justification type by clicking on
     one of the buttons. Only one choice from each option group is allowed. </para>
   </step>
</procedure>
  
<variablelist>
   <title>Horizontal justitfication options.</title>
   <varlistentry>
     <term><guibutton>General</guibutton></term>
     <listitem>
          <para>The standard default justification. This equates to right justifying
           numbers and formulas, and left justifying strings and labels.</para>
     </listitem>
   </varlistentry>
   <varlistentry>
      <term><guibutton>Left</guibutton></term>
      <listitem>
        <para>Left justitify all cell contents.</para>
      </listitem>
   </varlistentry>
   <varlistentry>
     <term><guibutton>Center</guibutton></term>
     <listitem>
       <para>Center all cell contents.</para>
     </listitem>
   </varlistentry>
   <varlistentry>
     <term><guibutton>Right</guibutton></term>
     <listitem>
       <para>Right justify all cell contents.</para>
     </listitem>
   </varlistentry>
   <varlistentry>
     <term><guibutton>Fill</guibutton></term>
       <listitem>
          <para>Fill the cell with the contents. This will stretch the cells
                contents to fill the space.</para>
       </listitem>
      </varlistentry>
      <varlistentry>
	<term><guibutton>Justify</guibutton></term>
	<listitem>
	  <para>Left justify and vertically center the cells contents.</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><guibutton>Center across selection</guibutton></term>
	<listitem>
	  <para>
	    Centers the cell's contents so the middle of each line is
	    aligned with the middle of other lines.  This only works
	    with multiple cells.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>

<variablelist>
   <title>Vertical Justification options.</title>
<varlistentry>
   <term><guibutton>Top</guibutton></term>
   <listitem><para>Align the top of the cells contents with the top of the cell.</para></listitem>
</varlistentry>
<varlistentry>
   <term><guibutton>Center</guibutton></term>
   <listitem><para>Center the cells contents vertically. Equally space between the top and bottom</para></listitem>
</varlistentry>
<varlistentry>
   <term><guibutton>Bottom</guibutton></term>
   <listitem><para>Align the contents of the cell with the bottom of the cell.</para></listitem>
</varlistentry>
<varlistentry>
   <term><guibutton>Justify</guibutton></term>
   <listitem><para>Lays out the lines in even spaces to fill the
   entire cell.  This only works with cells that have text that can wrap.</para></listitem>
</varlistentry>
</variablelist>

</sect2>

<sect2 id="number-format-bold-italics">
   <title>Cell Formatting options on the buttonbar.</title>

  <para>For frequently applied formats, there are some quick
 access buttons on the button bar. </para>

<figure id="number-format-buttonbar">
  <title>Example of justification quick buttons.</title>
  <screenshot>
     <graphic fileref="figures/number-format-buttonbar.png"></graphic>
   </screenshot>
</figure>

  <para> 
    See <xref linkend="fmt-toolbar"> for more detail one what these
    buttons do.
  </para>

 </sect2>
</sect1>

  <sect1 id="number-formatting-overview">
  <title>Number formatting overview</title>
  <para>
    The number formatting engine in Gnumeric is very powerful: it
    can be used to display numbers in various formats as well as
    providing the user with the ability to specify colors based on
    various simple conditions.
  </para>

  <para> The available catagories of
  pre-defined formats are :
  <example id="number-format-list">
    <title>Number Format Categories</title>
    <programlisting>
  General		A swiss army knife of a format.  It will attempt
                        to display a value it the 'best' way possible.
			The choice of format depends on the size of the cell
			and gnumeric's estimate of what 'type' of value is
			being displayed (number, date, time ...).

  Number		Displays numbers with 0-30 digits after the decimal
			place.  Negatives can be displayed normally, within
			parenthises, or turning Red.  Optionally a delimiter
			can be added every third order of magnitude (thousand,
			million, ...).  Both the decimal point and the
			thousands separator have internationalization support.

  Currency		Is very similar to Number, with the addition of a
			currency symbol.  Currently known symbols include '$'
			and the three letter abreviations of a ll major
			currencies.

  Accounting		A specialization of Currency which pays more attention
			to the alignment of negative numbers.  It ensures that
			A small amount of space is prepended to positive
			numbers so that that align with negatives.
			ie
			    ' 600.123 ' : Note the spaces for the positive number
			    '-500.456 ' : in 1 format for negatives.
			    '(500.456)' : in another.

  Date			The various permutations and combinations of
			predefined date representations big to expose the
			underlying format specification language
			<xref linkend="number-format-date-time-examples">
			The short version is that years can be 2 or 4 digit
			(yy or yyyy).  Months can be as many digits as needed
			(m), always 2 digits (mm), or as the short form (mmm).
			Days can be as many digits as needed (d) or two digits
			(dd).  The various other characters offer a choice of
			separators.

  Time			As with dates predefined time formats are selected
			using their specification.  Hours (h), minutes (mm),
			seconds (ss).  Sometimes it is necessary to display
			more than 24 hours, or more that 60 minutes/seconds
			without the values incrementing the display unit of
			the next larger measure (ie 25 hours instead of 1day +
			1hour).  For that instance you can use '[h]', '[m]' or
			'[s]'.

  Percentage		Multiplies a value by 100 and appends a percent.
			Can be used with 0-30 digits after the decimal place.

  Fractions		Approximate the value with a rational number with either
  			a specific denominator or with a maximum number of digits
			in the denominator.

  Scientific		Formats the value using scientific notation
			and 0-30 digits after the decimal place.  No provision
			for controling the exponent are provided at this time.

  Text			Treats numeric values as text.  This will show a
			number with as much precision as available and will
			lose knowledge of whether it represented a date, or
			time.

  Custom		This provides a list of the format specifications for
			all predefined formats and allows a user to enter
			create new specialized types.
	</programlisting>
    </example>
  </para>

  <para> <xref linkend="formula-example-1"> is an example of some of 
  the many variations of formatting one can apply to a number with 
  the preset formats.  The currency and its placement is locale
  specific
  </para>
  
  <example id="formula-example-1">
    <title>Some examples of number formatting</title>
    <programlisting>
      
      For the number 600.123
      
      Numbers
         General:                                           '600.123'
             0.0:                                           '600.1'
      Accounting
          _($*#,##0_);_($*(#,##0);_($*"-"_);_(@_)           ' $600 '
          _($*#,##0.00_);_($*(#,##0.00);_($*"-"??_);_(@_)   ' $600.12 '
      Scientific
           0.000E+00                                        '600.123'
      
	</programlisting>
    </example>

</sect1>

<sect1 id="data-and-time-formatting">
<title>Date and Time formatting</title>
   <para>Gnumeric supports a wide variety of date and time formatting.</para>

   <para>These formats can be used to convert an existing time
   into a new more readable format, or dates can be entered in these formats
   and Gnumeric will automatically convert them to a serial number with the
   proper cell format. See <xref linkend="entering-dates-and-numbers"> for more
   information.</para>

   <para>In <xref linkend="number-format-date-time-examples">  'd' is a day,
  'm' is a month, 'y' is a year, 'h' is an hour, and 's' is a second.  The default set
  of formats is locale specific.  <application>Gnumeric</application> attempts
  to guess whether the locale puts months before days or vice versa.
  </para>

   <example id="number-format-date-time-examples">
<title>Date and Time Formatting.</title>
<programlisting>

Time
    Format				Sample

    General				36068.755
    m/d/yy		d/m/yy		9/30/98 	(30/9/98)
    m/d/yyyy		d/m/yyyy	9/30/1998 	(30/9/1998)
    d-mmm-yy		mmm-d-yy	30-Sep-98	(Sep-30-98)
    d-mmm-yyyy		mmm-d-yyyy	30-Sep-1998	(Sep-30-9198)
    d-mmm		mmm-d		30-Sep		(Sep-30)
    d-mm		mm-d		30-09		(09-30)
    mmm/d		d/mmm		Sep/30		(30/Sep)
    mm/d		d/mm		09/30		(30/09)
    mm/dd/yy		dd/mm/yy	09/30/98	(30/09/98)
    mm/dd/yyyy		dd/mm/yyyy	09/30/1998	(30/09/1998)
    mmm/dd/yy		dd/mmm/yy	Sep/30/98	(30/Sep/98)
    mmm/dd/yyyy		dd/mmm/yyyy	Sep/30/1998	(30/Sep/1998)
    mmm/ddd/yy		ddd/mmm/yy	Sep/Wed/98	(Wed/Sep/98)
    mmm/ddd/yyyy	ddd/mmm/yyyy	Sep/Wed/1998	(Wed/Sep/1998)
    mm/ddd/yy		ddd/mm/yy	09/Wed/98	(Wed/09/98)
    mm/ddd/yyyy		ddd/mm/yyyy	09/Wed/1998	(Wed/09/1998)
    mmm-yy				Sep-98
    mmm-yyyy				Sep-1998
    mmmm-yy				September-98
    mmmm-yyyy				September-1998
    d/m/yy h:mm		m/d/yy h:mm	9/30/98 18:07	(30/9/98 187:07)
    d/m/yyyy h:mm	m/d/yyyy h:mm	9/30/1998 18:07	(30/9/1998 187:07)
    yyyy/mm/d				1998/09/30
    yyyy/mmm/d				1998/Sep/30
    yyyy/mm/dd				1998/09/30
    yyyy/mmm/dd				1998/Sep/30
    yyyy-mm-d				1998-09-30
    yyyy-mmm-d				1998-Sep-30
    yyyy-mm-dd				1998-09-30
    yyyy-mmm-dd				1998-Sep-30
    yy
    yyyy

Time
    Format				Sample

    General				36068.755
    h:mm AM/PM				6:07 PM
    h:mm:ss AM/PM			6:07:12 PM
    h:mm				18:07
    h:mm:ss				18:07:12
    m/d/yy h:mm		(d/m/yy h:mm)	9/30/98 18:07	(30/9/98 18:07)
    mm:ss				07:12
    [h]:mm:ss				865650:07:12
    [h]:mm				865650:07
    [mm]:ss				51939007:12
    [ss]				3116340432

</programlisting>
</example>

</sect1>
