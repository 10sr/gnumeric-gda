2000-03-25  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-format-toolbar.c (change_font_in_selection_cmd) :
	  Switch to the gnumeric gtk-combo-text.
	(workbook_create_format_toolbar) : Pass in a default colour.
	(fore_color_changed) : Handle the NULL indicator as auto colour.
	  Hard code to black for now.
	(back_color_changed) : Handle the NULL indicator as no background.

2000-03-25  Jon K Hellan  <hellan@acm.org>

	* src/dialogs/workbook-attr.glade: Deflickerize + set initial focus.

2000-03-25  Jody Goldberg <jgoldberg@home.com>

	* src/print.c (print_page) : Call setup_rotation unconditionally it
	  will decide when to rotate.  Honour the repeat_{top,left}.use flags.
	(print_page) : Add a clip path around the entire page to ensure that spans
	  get clipped at the margin.
	(print_job_info_init_sheet) : Use the repeat_{top,left}.use flags.

	* src/commands.c (cmd_ins_del_row_col_{redo,undo}) : Use sheet_update.

	* src/sheet.c (sheet_insert_{cols,rows}, sheet_delete_{cols,rows}) :
	  Set the visibility notification flags.
	(sheet_restore_row_col_sizes) : Ditto.

2000-03-25  Almer. S. Tigelaar.  <almer1@dds.nl>

	* src/dialogs/dialog-stf.h, src/dialogs/dialog-stf.c : Added a
	stf_dialog prefix to all functions and changed dialog_stf into
	stf_dialog, this makes more sense as the same naming convention
	was used in src/stf-parse.[ch] and src/dialogs/dialog-stf-preview.[ch]
	
	* src/dialogs/dialog-stf-main-page.c : idem
	* src/dialogs/dialog-stf-csv-page.c : idem
	* src/dialogs/dialog-stf-fixed-page.c : idem
	* src/dialogs/dialog-stf-format-page.c : idem
	* src/dialogs/dialog-stf-preview.c : idem

	* src/stf.c : Uses the renamed functions
	* src/clipboard.c : idem
	
2000-03-24  Miguel de Icaza  <miguel@helixcode.com>

	* src/file.c (workbook_import): Destroy the toplevel not the
	hack_dialog. 

	* src/dialogs/dialog-stf.c (dialog_stf_druid_page_cancel): Quit
	the event loop.  Should fix #cd 7782

	* src/workbook.c (workbook_set_arg): Add missing breaks to the
	argument code.

2000-03-25  Michael Meeks  <michael@helixcode.com>

	* src/ranges.c (range_fragment_list_clip): totaly re-write.
	(ranges_dump): implemented.

	* src/sheet-style.c (sheet_unique_cb): use frags not middle_list to
	calculate the style ( doh! ).

2000-03-24  Michael Meeks  <michael@helixcode.com>

	* src/ranges.c (range_overlap): kill (range_split_ranges): kill inline,
	it ruins debugging.

	* src/ranges.h (range_overlap): Macroify + add misc. documentation.

	* src/ranges.c (range_fragment_list_clip): fix frightening logic bug.

2000-03-22  Michael Meeks  <michael@helixcode.com>

	* src/ranges.c (range_fragment_list_clip): kill supid bug removing
	list items whilst iterating the list + add the clip region to the list
	temporarily.

2000-03-24  JP Rosevear  <jpr@arcavia.com>

	* src/dialogs/workbook-attr.glade.h: Dialog translation header.

	* src/dialogs/workbook-attr.glade: New dialog file for workbook
	attributes.

	* src/dialogs/dialog-workbook-attr.c : New file to display a
	workbook attribute dialog.
	(dialog_workbook_attr): Basic preparation.
	(attr_dialog_impl): Setup the dialog and display it.
	(attr_dialog_init_view_page): Initialize the view tab of 
	the workbook.
	(cb_show_hsb_toggled): Widget callback
	(cb_show_vsb_toggled): ditto
	(cb_show_tabs_toggled): ditto
	(cb_attr_dialog_dialog_destroy): Destroy callback.
	(cb_attr_dialog_dialog_apply): Apply callback - this needs to be
	more sophisticated and use a command for undo/redo purposes.

	* src/dialogs/Makefile.am: Setup for new files.

	* src/dialogs/dialogs.h: Define new dialog function.

	* src/workbook.c : Update menus for new workbook dialog under 
	the format menu and remove now unused callbacks.
	(workbook_get_arg): Put breaks in so we don't get
	stupid errors.
	(workbook_set_arg): ditto
	(workbook_attr_cmd): New call back for menu option

	* src/xml-io.c (xml_arg_set): Add more types for conversion.
	(xml_arg_get): Add more types for conversion.

2000-03-24  Jody Goldberg <jgoldberg@home.com>

	* src/expr.c (cellref_relocate): Simply code to implement correct logic.

	* src/main.c : Add debug_excel_objects.

2000-03-24  Jody Goldberg <jgoldberg@home.com>

	From: Sebastian Wilhelmi <wilhelmi@ira.uka.de>
	* src/functions/fn-lookup.c (gnumeric_lookup): Use the bound and the
	  index for the destination rather than the source.

2000-03-24  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gnumeric_sheet_set_left_col): 
	Fix cut-n-paste-o.

2000-03-24  Tuomas Kuosmanen  <tigert@gimp.org>

	* src/pixmaps/function_selector.xpm: New pixmap for Function
	Selection Wizard 
	
	* src/pixmaps/sort-ascending.xpm 
	* src/pixmaps/sort-descending.xpm: New versions of the sort icons,
	we dont sort by numeric value so we dont want to use 123 in the icon
	either. Instead we use A..Z and Z..A.

2000-03-23  Jody Goldberg <jgoldberg@home.com>

	* src/cell.c (cell_set_text_simple): Do NOT set the entered text
	when importing non string values.  There are still gotchas
	elsewhere. eg enter 90 format to current and edit box shows
	something that we can not parse.

2000-04-23  Morten Welinder  <terra@diku.dk>

	* src/history.c (history_menu_remove_items): Don't crash.

	* src/regression.c (general_linear_regression): Don't do
 	extra_stat in case of error.
	(general_linear_regression): Zero extra_stat.

	* src/history.c (history_menu_remove_items): Warning killer.

	* src/item-edit.c (scan_at): Fix usual signed/unsigned problem.

	* src/stf-parse.c (stf_parse_csv_is_separator): Ditto.
	(stf_parse_is_valid_data): Ditto.

2000-03-23  Jody Goldberg <jgoldberg@home.com>

	* src/main.h : include popt-gnome.h rather than popt.h.  We may
	eventually need gnome-popt.h, but lets keep this simple for now.
	Does anyone know the right way to do this ?

	* src/cell.c (cell_calculate_span) : Add CENTER_ACROSS_SELECTION.
	(cell_set_text_simple) : Begin transition to checking
	format of current cell for match.  No real change yet.

	* idl/Gnumeric.idl : Add CENTER_ACROSS_SELECTION.
	* src/cell-draw.c (cell_draw) : Ditto.
	* src/print-cell.c (print_cell) : Ditto.
	* src/corba-sheet.c (Sheet_cell_set_alignment) : Ditto.
	(Sheet_cell_get_alignment) : Ditto.
	* src/dialogs/dialog-cell-format.c (fmt_dialog_init_align_page) : Ditto.
	* src/dialogs/cell-format.glade : Ditto, reorganize alignment page.

	* src/format.c : Move definition of _StyleFormatEntry from mstyle.h.

	* src/number-match.c (format_create_regexp) : Extend to support
	currency names.

	* src/item-grid.c (item_grid_draw_border) : minor optimization for
	non-border case.

2000-03-23  Miguel de Icaza  <miguel@helixcode.com>

	* src/gnumeric-sheet.c (start_cell_selection_at): Disable feedback
	when the anting cursor is created
	(gnumeric_sheet_stop_cell_selection): Enable feedback when the
	anting cursor is destroyed.

	* src/item-edit.c (scan_for_range): Enable feedback only if we are
	allowed to.
	(item_edit_enable_highlight, item_edit_disable_highlight): New
	functions to control the feedback display.

2000-03-21  Miguel de Icaza  <miguel@helixcode.com>

	* src/sheet-vector.c (impl_vector_set_notify): Duplicate the
	object here.

2000-03-23  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gnumeric_sheet_set_{left_col, top_row}):
	Replace scrolling.

	* src/item-grid.c (item_grid_find_row): Add some old fixes that went
	into find_col but not find_row ??

2000-03-22  Michael Meeks  <michael@helixcode.com>

	* src/sheet-style.c (sheet_style_cache_flush): add 'all' flag to
	signify a hard vs. soft flush, freeze hash when it is a nice size. Do
	not bother destroying the hash table.
	(sheet_mstyle_compute_from_list): kill debug in inner loop + add another
	short circuit. (calc_grown_range): Spread the range better near the
	edges.

	* src/mstyle.c (mstyle_do_merge): simplify + add vital short circuit for
	factor of 2 speedup on blank regions. (mstyle_get_*): kill redundant NULL
	preconditions.

	* src/main.c (gnumeric_main): add the tests again.

2000-03-18  Michael Meeks  <michael@helixcode.com>

	* src/mstyle.c (mstyle_do_merge): Use pointer increment to kill mul in
	inner loop. (mstyle_element_ref): take a pointer.

	* src/sheet-style.c: Clean internals a lot, kill the nasty dereference
	macros, hash on CellPos to decrease memory usage.

	* src/dialogs/dialog-cell-format.c (draw_format_preview): Clip the
	sample down if it is a massive string to stop the dialog from becoming
	stupidly wide.

2000-03-23  Jon K Hellan  <hellan@acm.org>

	* src/stf.c (stf_read_workbook): Set save info, preferred format
	XML, level manual.

	* src/file.[ch] (file_format_register_save): Add "level" parameter.

	* src/file.h: (FileFormatLevel): Add the enum. At the best level,
	the save command saves to the given name without asking.  At the
	worst level, no name has been assigned.
	
	* src/file.c (_FileSaver): Add "level" member.
	(file_format_unregister_save): Set level to manual for workbooks
	which had this saver set.
	(cb_unregister_save): New function. Helper for
	file_format_unregister_save. 
	(workbook_read): Set save info. Tag as new.
	(workbook_import): No longer set needs_name - importer will have
	set file_format_level.
	(fs_set_filename): New function: Set default filename in the file
	selection dialog.
	(workbook_save_as): Use fs_set_filename. Set save info.
	(workbook_save): Punt to workbook_save_as if file_format_level <
	AUTO. Save using wb->file_save_fn.

	* src/workbook.[ch] (workbook_set_saveinfo): New function. Set
	filename, level and save function, but do nothing if we already
	have info at a higher level.
	
	* src/workbook.h (struct _Workbook): Replace needs_name with
	file_format_level. Add file_save_fn member. Include file.h
	(workbook_set_saveinfo): Add "level" parameter.

	* src/workbook.c (workbook_do_destroy): Insert in history list
	when file format level > "new". We used to test needs_name.
	(workbook_is_pristine): Test file_format_level > "new" instead of
	needs_name true.
	(workbook_new): Tag workbook as new. Set save function.
	(workbook_set_filename): needs_name has no longer exists. Don't
	set it.

	* src/xml-io.c (gnumeric_xml_read_workbook): Set save info. Tag as
	AUTO.
	(xml_init): Tag saver as AUTO.

	* src/corba-workbook.c (Workbook_set_filename): Add FIXME comment.

	* src/history.c (history_item_label): Strip extension only when it
	is ".gnumeric".

2000-03-22  Jody Goldberg <jgoldberg@home.com>

	* src/functions/fn-lookup.c (gnumeric_index) : The current
	  implementation supports arrays and references. It does not support
	  the special case of index 0,0 returning the entire range, nor does
	  it support the second syntax (ref, row, col, area_num).
	(gnumeric_match) : Document that only match_type == 0 works.

2000-03-22  JP Rosevear  <jpr@arcavia.com>

	* src/xml-io.c (xml_arg_set): Set an arg value based on type and
	contents in the xml tree.
	(xml_arg_get): Get a string representing an arg's value.
	(xml_write_attributes): Create the list of attributes.
	(xml_free_arg_list): Function to free the args in a GList.
	(xml_read_attributes): Read the attributes back in from the 
	xml tree.
	(xml_workbook_read): Read the workbook attributes in and set them.
	(xml_workbook_write): Write out the workbook attributes.

	* src/workbook.c (workbook_class_init): Add three args, the h & v 
	scrollbars and the notebook tab.  Override parent set_arg and get_arg
	functions.
	(workbook_set_arg): New function to handle arg setting.
	(workbook_get_arg): New function to handle getting args.
	(workbook_set_attributev): Set a whole list of args for the object.
	(workbook_get_attributev): Return an array of args for the workbook.

	* src/workbook.c (sort_cmd): Sort all the columns in order so 
	that ties are broken nicely (pointed out by meeks)

2000-03-22  Jody Goldberg <jgoldberg@home.com>

	* src/plugin.c (plugin_load) : Typo.

	* src/workbook.c (recalc_cmd) : Bug7739.

2000-03-22  Chema Celorio  <chema@celorio.com>

	* idl/.cvsignore: Created .cvsignore added Makefiles

2000-03-22  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_reposition_comments) : Merged from
	  sheet_reposition_comments_from_row and
	  sheet_reposition_comments_from_col.

	(sheet_update) : New function.  Use the new update flags from
	  SheetPrivate that are set in the col/row resize functions
	  to do delayed resizing and updates.  This allows the resizing to be
	  batched for an entire logical operation.
	(sheet_{col,row}_set_size_pixels) : Set the update flags.

	* src/workbook-cmd-format.c (workbook_cmd_format_{row,column}_auto_fit) : No need to
	  worry about redraws.  Use sheet_update.
	(workbook_cmd_format_{row_height,column_width}) : Ditto.

	* src/sheet-view.c (sheet_view_redraw_cell_region) : No need to
	  recalculate the spans,  Use the pre-calculated versions.
	(sheet_view_col_size_changed) : Use sheet_update.
	(sheet_view_row_size_changed) : Ditto.

	* src/sheet-style.c (re_dimension_cells_cb) : Use cell_calc_dimensions.
	(sheet_cells_update) : No need to redraw per cell and guess the bound.
	  It is simpler and more correct to calc dimension per cell, and
	  redraw the region BEFORE and AFTER to handle spans.

	* src/cell.[ch] (cell_style_changed) : Delete.

	* src/cell-draw.c (cell_draw) : continue syncing with print code.
	  Be even more careful in the possible presence of style bugs.
	* src/item-grid.c (item_grid_draw) : Ditto.
	* src/print-cell.c (print_cell) : Ditto.

	* src/analysis-tools.c (correlation_tool) : Use sheet_update.
	(covariance_tool) : Ditto.
	(ttest_paired_tool) : Ditto.
	(ttest_eq_var_tool) : Ditto.
	(ttest_neq_var_tool) : Ditto.
	(ftest_tool) : Ditto.

2000-03-21  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-private.h : Add status flags to accumulate state changes
	  for later redraw.

	* src/commands.c (cmd_format_redo) : Use sheet_update
	  in case the row/col sizes changed due to font size changes.
	(cmd_format_undo) : Ditto.

	* src/widgets/gtk-combo-box.c (cb_state_change) : Only pseudo-prelight
	  the display when over the arrow, not vice versa.
	(gtk_combo_box_init) : Ditto.
	(gtk_combo_box_set_display) : Ditto.

	* src/sheet.c (sheet_row_get_distance_pts) : Enable reversed indicies.
	(sheet_col_get_distance_pts) : Ditto.

	* src/plugin.c (plugin_load) : Add more version checking to ensure
	  that very old plugins that do not check their versions can not be
	  loaded.

2000-03-20  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gnumeric_sheet_make_cell_visible) : When
	  forcing a scroll do a hard reset of the visible ranges.
	(gnumeric_sheet_compute_visible_ranges) : Ditto.
	(gnumeric_sheet_set_top_row) : Remove extraneous scroll.
	(gnumeric_sheet_set_left_col) : Remove extraneous scroll.

2000-03-21  Miguel de Icaza  <miguel@helixcode.com>

	* src/utils.c (parse_cell_name_or_range): Allow for parsing to be
	non-strict. 

	* src/ranges.c (range_parse): Allow for parsing to be non-strict.

	* src/utils.c (parse_cell_name): Allow for parsing to be non-strict.

	* Makefile.am (SUBDIRS): Fix list of directories.

	* src/item-cursor.c (item_cursor_set_arg): Added optional color
	handling to item-cursor.

2000-03-20  Miguel de Icaza  <miguel@helixcode.com>

	* src/main.c (gnumeric_main): Removed broken style test.

	* src/ranges.c (range_parse): Update the range_parse API

	* src/print-info.c (load_range): Update API.

	* src/utils.c (parse_cell_name): Handle references that contain an
	absolute reference.

2000-03-19  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_move_range) : Move the styles before the contents
	  so that spans are calculated correctly.

	* src/workbook.c (workbook_start_editing_at_cursor) : Redraw the
	  edit cell so that we handle spans correctly.
	(workbook_finish_editing) : Ditto.

	* src/item-grid.c (item_grid_draw) : Ignore spans while editing a
	  cell.

2000-03-16  Nick Lamb  <njl195@zepler.org.uk>

	* configure.in: Fix typo (we need 0.13, not 0.11 of gnome-print)

2000-03-16  Michael Meeks  <michael@helixcode.com>

	* src/test.[ch]: Create to help profiling.

	* src/main.c: Add style testing.

2000-03-14  Michael Meeks  <michael@helixcode.com>

	* src/xml-io.c (xml_write_style): comment out the default checks on
	style colors, We may want these back when we have sheet default colors.

2000-03-13  Michael Meeks  <michael@helixcode.com>

	* src/sheet-object-bonobo.c (sheet_object_bonobo_destroy): fix.

2000-03-18   JP Rosevear <jpr@arcavia.com>

	* src/pixmaps: Added sort-ascend.xpm, sort-descend.xpm, 
	insert-bonobo-component.xpm

	* src/pixmaps.h: Include new xpms.

	* src/workbook.c (sort_cmd): Moved from workbook-format-toolbar.c
	(sort_ascend_cmd): ditto
	(sort_descend_cmd): ditto
	
	* src/dialogs/dialog-cell-sort.c (dialog_cell_sort): Duh, 
	pass the parameters in the correct order.

	* src/workbook-format-toolbar.c: Move sort commands to workbook.c
	and put icons into command toolbar.

2000-03-17  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object.c (create_object, sheet_set_mode_type_full):
	Make it compile and link without Bonobo.

2000-03-13  Miguel de Icaza  <miguel@helixcode.com>

	* src/sheet-vector.c (sheet_vectors_cell_changed): Change NULL to
	CORBA_OBJECT_NIL 

	* src/sheet-object-bonobo.c (sheet_object_bonobo_load_from_file):
	Use the new IDL:Bonobo interface name, not the IDL:GNOME one
	(sheet_object_bonobo_load_from_file): ditto.
	(sheet_object_bonobo_load): ditto.

	* src/sheet-object.c (sheet_set_mode_type): Temporary hack to get
	the graphics working under 1:20 hours when my battery runs out of
	power. 

	* src/sheet-object-container.c
	(sheet_object_container_new_from_goadid): Renamed from
	sheet_object_container_new

	(sheet_object_container_new): Now takes a BonoboObjectClient as an
	argument. 

2000-03-12  Miguel de Icaza  <miguel@helixcode.com>

	* src/sheet-vector.c (impl_vector_get_numbers): Increment idx
	here;  
	(impl_vector_get_vec_values): ditto.
	(impl_vector_get_numbers): Use the proper values for the columns
	row. 
	(impl_vector_get_vec_values): ditto.

	* src/clipboard.c (x_clipboard_bind_workbook): Fix memory leak.
	The problem is worse, because the warning comment there was
	completely bogus.

2000-03-14  Jon K Hellan  <hellan@acm.org>

	* src/workbook-view.c (workbook_view_history_update,
	workbook_view_history_shrink): ): We introduce numbers in front of
	the the history file names for the following reasons:
	1. Bonobo won't let you make 2 entries with the same label in the
	   same menu. But that's what happens if you e.g. access
	   worksheets with the same name from 2 different directories.
	2. The numbers are useful accelerators.  
	This means that when a new item is added, all existing entries get
	a new number. We access them via the label, so we have to remove
	all the old list entries and make a new list.

	history_menu_flush is called to remove the old list,
	history_menu_update to build the new.
	
	* src/history.c
	(history_item_label): Add accel_number parameter, make label from
	accel_number and basename. Rename basename variable to label.
	(history_menu_item_create): Add accel_number parameter. Use it
	when calling history_item_label.
	(history_menu_locate_separator): New static function. Locate the
	menu and position of history separator. They may not yet exist.
	(history_menu_insert_separator): New static function. Insert the
	history separator. Return its position and the menu shell.
	(history_menu_insert_items): New static function. Add the history
	items to the file menu.
	(history_menu_remove_items): New static function. Remove the
	history items from the file menu.
	(history_menu_setup): Split into lots of twisty little functions,
	all different.
	(history_menu_fill): New exported function. Make the menus for
	the workbooks show the new history list.
	(history_menu_flush): New exported function. Remove the history
	list from the file menus of all workbooks.
	(history_insert_menu_item): Remove.
	(history_remove_menu_item): Remove.
	
	* src/history.h
	(history_menu_fill, history_menu_flush): Declare.
	(history_insert_menu_item, history_remove_menu_item): Remove.

2000-03-13  Jody Goldberg <jgoldberg@home.com>

	* wizards/graphics/Makefile.am : Include the idl build dir rather than
	  src dir.  We are interested in the resulting code not the original
	  idl.

2000-03-13  Jon K Hellan  <hellan@acm.org>

	* src/main.c (main): Silence warning.

2000-03-13  Jody Goldberg <jgoldberg@home.com>

	* Makefile.am : Make wizards and graph subdirs contingent on bonobo.
	  distribute all the ChangeLogs.

2000-03-12  JP Rosevear  <jpr@arcavia.com>

	* src/dialogs/dialog-cell-sort.c : Remove clip_range_to_finite.
	(dialog_cell_sort): Use range_clip_to_finite.

	* src/ranges.c (range_clip_to_finite): Make the range finite using
	sheet_get_extent if its infinite.

	* src/ranges.h: Prototype range_clip_to_finite.

	* src/workbook-format-toolbar.c (sort_cmd): Sort the current 
	selection if simple.
	(sort_ascend_cmd): Call sort_cmd with asc=0.
	(sort_descend_cmd): Call sort_cmd with asc=1.

	* src/workbook-format-toolbar.c : Add sort ascend/descend buttons.
	(sort_ascend_cmd): New toolbar callback function to sort 
	selection in ascending order. 
	(sort_descend_cmd): New toolbar callback function to sort
	selection in descending order.
	

2000-03-12  JP Rosevear  <jpr@arcavia.com>

	* src/Makefile.am: Reflect new location of idl.

2000-03-12  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_selection_event) : Be more careful
	  handling selecting the cursor from the external or internal edge
	  this will avoid what seems like an off by one error. Thanks Jacob.

2000-03-11  Miguel de Icaza  <miguel@helixcode.com>

	* src/Makefile.am: Cleaned Makefile.

	* graph/Makefile.am: ditto.
	
	* graph/sample.c: fix
	
	* idl/Makefile.am, idl/Graph.idl, idl/Gnumeric.idl: Moved IDL
	files here, and create the libGnumeric.a and libGraph.a libraries
	here. 

2000-03-11  Jody Goldberg <jgoldberg@home.com>

	* src/workbook.c (workbook_setup_edit_area) : Use sensitize rather
	  than show/hide for the ok/cancel buttons.  Return wizard back
	  to end of list.
	(workbook_new) : Revert last change, no longer necessary.
	(workbook_start_editing_at_cursor) : Sensitize the ok/cancel edit buttons.
	(workbook_finish_editing) : desensitize them.

2000-03-11  Jody Goldberg <jgoldberg@home.com>

	* src/workbook.c (cb_editline_focus_in) : When the edit lined receives
	  focus start editing.
	(accept_input) : No need to force edit mode we should already be in
	  edit mode.
	(workbook_setup_edit_area) : Move the wizard button to the begining of
	  the list and store the ok and cancel buttons in the Private section.
	  Hook cb_editline_focus_in to focus-in.
	(workbook_new) : After show_all, we need to hide the ok/cancel edit
	  buttons.  We start out not editing.
	(workbook_start_editing_at_cursor) : Show the ok/cancel edit buttons.
	(workbook_finish_editing) : Hide them.

2000-03-11  Jon K Hellan  <hellan@acm.org>

	* src/main.c (main): #ifdef out the fix for now.

2000-03-11  Jon K Hellan  <hellan@acm.org>

	* src/main.c (main): Work around guile / gnorba problem: gnorba
	closes stdin, and scm_boot_guile segfaults if any of the stdio
	streams are missing. We map the missing streams to /dev/null.

2000-03-10 Alastair McKinstry <mckinstry@computer.org>

	* configure.in (ALL_LINGUAS): Added ga (Irish) translation.

	 * gnumeric.desktop: Added Irish (ga) translation.

2000-03-10  Jody Goldberg <jgoldberg@home.com>

	* src/func.c (tokenized_help_new) : Constness.

	* src/widgets/gtk-combo-box.c (cb_state_change) : New function to keep
	  the state of the combo display button and the combo arrow in sync.
	(gtk_combo_box_init) : Connect cb_state_change to the arrow.
	(gtk_combo_box_set_display) : Ditto for the display widget.

	* src/sheet.c (sheet_set_zoom_factor) : Bound the factor at 10% and 500%

	* src/workbook.c (change_zoom_in_current_sheet_cb) :
	  call change_displayed_zoom_cb to adjust the combo to contain the
	(workbook_focus_current_sheet) : Only emit signal if the sheet
	  changed.

2000-03-08  Jody Goldberg <jgoldberg@home.com>

	* src/collect.c (callback_function_collect) : Treat arrays and ranges
	  as errors.

	* src/format.c (format_value) : formating a range returns a
	  #VALUE! message.

	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) :
	  Use the workbook flags, and delete the icky globals.
	(start_cell_selection_at) : Hide the std cursor when a cell selection
	  cursor is created.
	(gnumeric_sheet_stop_cell_selection) : Restore the std cursor.

2000-03-07  Jody Goldberg <jgoldberg@home.com>

	* src/workbook.c (accept_input) : Use workbook_finish_editing.
	(cancel_input) : Ditto.
	(do_focus_sheet) : Support range selection across spreadsheets.
	(workbook_get_sheet_position) : Fix and document.
	(workbook_move_sheet) : Fix.
	(workbook_focus_sheet) : Handle errors cleanly.
	(wb_edit_key_pressed) : Improve F4 handling.
	(wizard_input) : Begin non-modal function wizard.  NOT FINSIHED.
	(workbook_start_editing_at_cursor) : transfered from
	  sheet_start_editing_at_cursor.
	(workbook_finish_editing) : Distilled from sheet_{accept,cancel}_pending_input.
	(Workbook) : Add editing_cell, editing_sheet, editing.

	* src/sheet.c (sheet_stop_editing) : Delete.
	(sheet_accept_pending_input) : Merge into workbook_finish_editing.
	(sheet_cancel_pending_input) : Ditto.
	(sheet_start_editing_at_cursor) :
	(sheet_create_edit_cursor) : New function.
	(sheet_destroy_edit_cursor) : New function.
	(sheet_destroy_cell_select_cursor) :  New function.
	(Sheet) : Delete editing and editing_cell.

	* src/selection.c (sheet_selection_changed_hook) : Make public.  This
	  should eventually move but I'm not sure where.  It is used for more
	  than just changes in the selection in the current sheet.  It must
	  also be called when the sheet changes.  What it REALLY does it to
	  sync the shared workbook state with the current sheet's selection.

	* src/item-cursor.c (item_cursor_init) : Handle change from
	  sheet_accept_pending_input -> workbook_finish_editing.
	* src/item-grid.c (item_grid_button_1) : Ditto.

	* src/gnumeric-sheet.c (gnumeric_sheet_can_move_cursor) : Edit moved
	  from sheet -> workbook.
	(selection_insert_selection_string) : Extend to support
	  abs/rel refs and intersheet-refs.
	(gnumeric_sheet_stop_cell_selection) : Add clear_string argument
	  to optionally remove the selection range.
	(gnumeric_sheet_key_mode_sheet) : Adjust to movement of editing flag
	  from sheet -> workbook.  Be careful to use the original sheet when
	  moving rather than the current sheet.  Support F4 while editing.

	* src/cell-draw.c (cell_draw) : editing_cell has moved from sheet to
	  workbook.  Fix font ref leak when drawing the edit cell.

	* src/dialogs/dialog-function-wizard.c : Begin transition to being
	  non-modal.  NOT FINISHED.

2000-03-10  Michael Meeks  <michael@helixcode.com>

	* src/Makefile.am (sheet-vector.h): make it depend on Gnumeric.h
	not Vector.h

2000-03-09  Michael Meeks  <michael@helixcode.com>

	* src/sheet-object.c (sheet_set_mode_type): look for the
	IDL:Bonobo/ interfaces not stale IDL:GNOME ones.

2000-03-09  Jon K Hellan  <hellan@acm.org>

	* src/corba-workbook.c (command_context_corba): Really handle wb
	== NULL.

2000-03-08  Jon K Hellan  <hellan@acm.org>

	* src/corba-workbook-factory.c (WorkbookFactory_supports): 
	(GNOME_Gnumeric_WorkbookFactory__create): 
	Bonobo::GenericFactory::supports has been renamed to
	Bonobo::GenericFactory::manufactures. Replace supports with
	manufactures.

2000-03-08  Jon K Hellan  <hellan@acm.org>

	* src/corba-workbook.c (command_context_corba): Handle wb =
	NULL. It would segfault.

	* src/Gnumeric.idl: Fixed places where a name at an inner scope
	differs only in case from a name at an outer scope. This breaks
	the rule that identifiers cannot differ only in case, because an
	identifier from a surrounding scope is introduced into a scope if
	it is used in that scope. The solution is to scope the outer
	identifiers explicitly:
	(GNOME::Gnumeric::Sheet::cell_set_value): Change Value to
	Gnumeric::Value. 
	(GNOME::Gnumeric::Workbook::parse): Change Sheet to
	Gnumeric::Sheet.
	
	* src/dialogs/dialog-cell-comment.c (dialog_cell_comment): Set
	word wrap.

	* src/dialogs/dialog-summary.c (dialog_summary_update): Ditto.

2000-03-08  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/sheet.c (sheet_destroy): Fixed a leak (in
 	sheet->solver_parameters.input_entry_str).

2000-03-07  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/Vector.idl: Move the vector interfaces here.
	
	* src/Makefile.am: Arrange for compilation linking of Vector code.

2000-03-07  Almer. S. Tigelaar.  <almer1@dds.nl>

	Gnumeric instances can now eXchange data in a gnumeric
	XML clipboard format. This way style information and such
	can be preserved when copying/cutting from one instance
	to another.
	
	* src/xml-io.c, src/xml-io.h :
	Added some functions for the gnumeric clipboard xml format.
	(gnumeric_xml_read_selection_clipboard) : 
	For reading xml data from the clipboard 
	(gnumeric_xml_write_selection_clipboard) : 
	For writing xml data to the clipboard 
	(xml_read_selection_clipboard) : 
	For reading xml data from the clipboard, does the dirty work
	(xml_write_selection_clipboard) : 
	For writing xml data to the clipboard, does the dirty work
	(xml_read_cell_copy) : 
	Similar to xml_read_cell, but returns a CellCopy* instead 
	of a Cell*
	(xml_write_cell_and_position) : 
	Similar to old xml_write_cell but allows you to set the col and 
	row manually
	(xml_write_cell) :
	Calls upon xml_write_cell_and_position, but takes the col and row 
	from the ColRowInfo members of type Cell.
	(xml_read_style_region_ex) :
	Read the xml data and returns an mstyle and a range. Does 
	_NOT_ attach this to a sheet.
	(xml_read_style_region) :
	calls upon xml_read_style_region_ex and attaches the mstyle 
	to a sheet

	* src/cell.h
	New cellcopy type added CELL_COPY_TYPE_AND_COMMENT, if a
	cellcopy is of this type the comments will be put in 
	cellcopy.comment
	
	* src/clipboard.c
	(paste_cell_flags) :
	added support for the new CELL_COPY_TYPE_TEXT_AND_COMMENT copy type
	(x_selection_received) :
	Modified so it support the TARGETS and GNUMERIC XML atoms and renders
	the gnumeric clipboard xml format
	(x_selection_handler) :
	Now it can render theselection to ASCII text and gnumeric clipboard xml 
	format.
	(x_clipboard_bind_workbook) :
	Registers the new GNUMERIC XML atom that enables other instances of
	gnumeric to see that we are also gnumeric and can render the clipboard
	data in a the special gnumeric xml clipboard format
	(clipboard_release) :
	Handles new CELL_COPY_TYPE_TEXT_AND_COMMENT type

2000-03-01  Dom Lachowicz <dominicl@seas.upenn.edu>

	* src/dialogs/sheet-order.glade,
	  src/dialogs/sheet-order.glade.h,
	  src/dialogs/dialog-sheet-order.c: Created.

	* src/dialogs/Makefile.am: Added three above files to project

	* src/dialogs/dialogs.h (dialog_sheet_order): added new function
	
	* src/workbook.c (sheet_order_cmd): added
	(workbook_get_sheet_position, workbook_delete_sheet),
	(workbook_move_sheet, workbook_focus_sheet, wb_edit_key_pressed): updated.

	* src/workbook.h (workbook_delete_sheet, workbook_move_sheet): added

2000-03-06  Michael Meeks  <michael@helixcode.com>

	* src/Gnumeric.idl: add nasty mess copied from Bonobo.

	* src/Makefile.am ($(GNUMERIC_CORBA_GENERATED)): Add -D__GNUMERIC_COMPILE
	
2000-03-05  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* doc/C/solver.sgml, doc/C/images/solver-0[1,2,3,4,5].jpg: Added
	documentation of the Solver tool.

2000-03-05  Jody Goldberg <jgoldberg@home.com>

	* src/dialogs/dialog-cell-format.c : Enable the underline and
	  strikethrough elements. TODO : redo the preview for the font
	  tab to support underlining and friends.

	* src/dialogs/cell-format.glade : Rename the underline combo and
	  strikethrough button.

	* src/xml-io.c (xml_write_style) : Add strikethrough.
	(xml_read_style) : Ditto.

	* src/workbook-format-toolbar.c (workbook_feedback_set) : Only show
	  the underline button for single underlines.

	* src/sheet-view.[ch] : rename select_all -> select_all_btn.
	  remove unused element.

	* src/sheet-object.h : Remove silly self inclusion.

	* src/print-cell.c : Support underlining and strikethrough.
	  Move even closer into sync with drawing code.

	* src/mstyle.c : Add strikethrough and cleanup includes.

	* src/main.h : Add include for popt.h.

	* src/item-grid.c (item_grid_draw_border) : No more need for BOTTOM or
	  RIGHT.
	(item_grid_draw_cell) : Delete, and merge with draw_cell.

	* src/commands.c (cmd_set_text_undo) : Use cursor_set rather than
	  cursor_move.
	* src/corba-sheet.c (Sheet_cursor_move) : Ditto.
	(gnumeric_sheet_key_mode_sheet) : Ditto.
	* src/workbook.c (workbook_parse_and_jump) : Ditto.

	* src/cell-draw.c : Clean includes, add support for strikethrough.

2000-03-04  Morten Welinder  <terra@diku.dk>

	* src/sheet.c (r1c1_get_item): Fix signed/unsigned char confusion.

	* src/dialogs/dialog-autocorrect.c (autocorrect_tool): Massive
 	signed/unsigned char confusion.

	* src/solver-lp.c (find_name): Kill a warning.

	* src/func.c (function_get_category): Kill a warning.

	* src/dialogs/dialog-plugin-manager.c (refresh_right_frame): Kill
 	a warning.

2000-03-03  Jody Goldberg <jgoldberg@home.com>

	* src/cell-draw.c (cell_draw) : Correct off by one error for
	  right alignment.

	* src/print-cell.c (print_cell_text) : Ditto.
	(print_cell_range) : Don't forget to increment when dealing with
	  hidden cols/rows.

	* src/item-grid.c (item_grid_draw) : Ditto.

2000-03-01  Dom Lachowicz <dominicl@seas.upenn.edu>

	* src/dialogs/dialog-plugin-manager.c (add_to_clist, populate_clist),
	(add_cb, remove_cb, row_cb, remove_cb, dialog_plugin_manager),
	(dialog_plugin_manager_impl): Re-implemented dialog.
	(refresh_right_frame): New function

	* src/dialogs/plugin-manager.glade: updated.
	
	* src/dialogs/plugin-manager.glade.h: updated

2000-03-03  Morten Welinder  <terra@diku.dk>

	* src/workbook.c: Fix 6760.

2000-03-03  Jon K Hellan  <hellan@acm.org>

	* doc/python-gnumeric.txt: Updated documentation

2000-03-02  Jon K Hellan  <hellan@acm.org>

	* src/symbol.c (symbol_is_unused): Test went wrong way.
	(symbol_remove): Ditto.

2000-03-01  Dom Lachowicz <dominicl@seas.upenn.edu>

	* src/functions/fn-eng.c (val_to_base): Catch Div0 && invalid log()
	domain.

	* src/functions/fn-financial (gnumeric_accrint, gnumeric_recieved),
	(gnumeric_pricemat): Same

	* src/functions/fn-stat.c (gnumeric_ttest): Ditto
	
2000-03-02  Michael Meeks  <michael@helixcode.com>

	* src/sheet-vector.c (sheet_vector_corba_object_create): made static.
	(sheet_vector_new): setup sheet_vector->sheet.
	(sheet_vector_detach): re-arrange to compile.

2000-03-02  Jon K Hellan  <hellan@acm.org>

	* doc/python-gnumeric.txt: Updated documentation 

	* src/func.h: Make FunctionCategory.name a String * instead of
	gchar *. This was necessary to allow user defined categories.
	src/func.c (function_category_compare, function_get_category): Use
	new FunctionCategory. Fix wrong use of g_list_find_custom.
	(function_def_count_args, function_def_get_arg_type): Null pointer
	check.

	* src/dialogs/dialog-function-select.c (function_categories_fill):
	ditto.

2000-03-02  Almer. S. Tigelaar.  <almer1@dds.nl>

	* src/dialogs/dialog-stf-format-page.c
	* src/dialogs/dialog-stf-preview.c
	* src/dialogs/dialog-stf-preview.h
	* src/dialogs/dialog-stf.c
	Modified, the format page now really display formatted
	cells in the preview.
	NOTE : A downside of this is that the cache is no longer shared
	between fixed/csv pages and format pages.

	* src/dialogs/dialog-stf.c
	(dialog_stf_editables_enter) :
	Disabled "enter activates default button" for the TextIndicator
	field on the csv page. This would case the page to cycle, which 
	is ok, but it also caused the dropdown option to pop-up on the
	next page, which is not ok.

2000-03-02  Jon K Hellan  <hellan@acm.org>

	* src/dialogs/dialog-stf.c (dialog_stf_druid_page_cancel): In
	Yes/No dialog - set initial keyboard focus to "No". It went
	nowhere.
	(dialog_stf_set_initial_keyboard_focus): New function: Set
	keyboard focus to the an appropriate widget on the page.
	(dialog_stf_druid_page_next, dialog_stf_druid_page_previous): Set
	initial keyboard focus.
	(dialog_stf_druid_page_next): Make "Finish" button default on the the
	final page. This doesn't change behaviour, but cues the user
	visually.
	(dialog_stf_druid_page_previous): Restore "Next" button as default
	when coming from final page.
	(dialog_stf_check_escape): New function: Watch keypresses, and
	simulate "Cancel" when you see <Escape>.
	(dialog_stf_attach_page_signals): Connect dialog_stf_check_escape
	to handle <Escape>.
	(dialog_stf_editables_enter): New function: Make <Ret> in text
	fields activate default.
	(dialog_stf): Use dialog_stf_editables_enter,
	dialog_stf_set_initial_keyboard_focus. Make "next" button the
	default button. Make window a child of the workbook window. 

	* src/dialogs/dialog-stf-format-page.c (format_page_init): Make
	format list titles passive.

	* src/dialogs/dialog-stf-fixed-page.c (fixed_page_init): Make
	column list titles passive.

	* src/clipboard.c (x_selection_to_cell_region): Add command
	context to interface. Use it when calling dialog_stf.
	(x_selection_to_cell_region): 
	(x_selection_received): Call x_selection_to_cell_region with
	workbook_command_context_gui.
	
2000-03-02  Miguel de Icaza  <miguel@helixcode.com>

	* src/about.c (dialog_about): Changed to www.helixcode.com

2000-03-01  Miguel de Icaza  <miguel@helixcode.com>

	* src/parser.c (gnumeric_expr_parser): Make preconditions clear.

	* src/ranges.c: Removed gnome.h from the include list.

	* src/sheet.h: Fix comment.  The list contains SheetSelection
	structures not Ranges.

2000-03-01  Jon K Hellan  <hellan@acm.org>

	* src/dialogs/cell-format.glade: Font pane: Make accelerator for
	underline combo work. Enable strikethrough.

2000-03-01  Jody Goldberg <jgoldberg@home.com>

	* src/cell-draw.c (draw_text) : adjust placement of single vs double
	  underlining.

2000-03-01  Michael Meeks  <michael@helixcode.com>

	* configure.in: Bump required ver. of gnome-print.
 
	* src/style.c (style_font_get_height): hack for new gnome-print
 	to kill annoying warning.
 
2000-03-01  Jon K Hellan  <hellan@acm.org>

	* src/dialogs/cell-format.glade: Enable underline in fonts pane.

2000-03-01  Jon K Hellan  <hellan@acm.org>

	* src/dialogs/advanced-filter.glade: Added accelerators and some
	padding.

2000-02-29  Jody Goldberg <jgoldberg@home.com>

	* src/print-cell.c (print_cell_text) : Correct the docs,
	  and add clipping code.  The resulting postscript looks reasonable
	  now.  Unfortunately preview sucks.

	* src/sheet.c (sheet_get_extent_cb) : Teach about spans.
	(sheet_get_extent) : max_used is NOT a viable bound.  It limits the
	  cells with contents, but does not reflect spanning cells.

2000-02-29  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/cell.c (cell_content_changed): Notify the sheet that the
	cell changed using sheet_cell_changed.

	* src/sheet-vector.c: New file.  Implements the Gnumeric:Vector
	interface (and supports non-contiguous ranges)

	* src/sheet.c (sheet_destroy): free private structure.
	(sheet_new): init private structure.
	(sheet_cell_changed): New function.
	
	* src/sheet-private.h: New file.

	* src/sheet.h: Sheet structure includes SheetPrivate field now.

2000-02-29  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-format-toolbar.c (change_selection_font) : Add underline.
	(underline_cmd) : New function.
	(workbook_format_toolbar) : Add underline.
	(workbook_feedback_set) : Ditto.

	* src/xml-io.c (xml_read_style) : Restore underline style.
	(xml_write_style) : Save the underline style.

	* src/pattern.c (gnumeric_background_set_pc) : suppress warning.
	
	* src/mstyle.[ch] : Add MSTYLE_FONT_UNDERLINE.
	(mstyle_get_font_uline) : New function.
	(mstyle_set_font_uline) : New function.

	* src/cell-draw.c (draw_text) : new function to add underlines.
	(draw_overflow) : Use draw_text.
	(cell_draw) : Ditto.

	* src/gnumeric.h : Add StyleUnderlineType.

	* gnumeric.spec.in : Update the requirements.

2000-03-01  Jon K Hellan  <hellan@acm.org>

	* doc/python-gnumeric.txt: Clarified mapping of arrays.

2000-02-29  Jody Goldberg <jgoldberg@home.com>

	* src/cell-print.c : Sync with logic in item-bar::draw to add borders
	  and more correctly handle spanning.

	* src/pattern.c (gnumeric_background_set_pc) : New routine cloned from
	  gnumeric_background_set_gc.

	* src/border.c (style_border_set_pc_dash) : New routine cloned from
	  style_border_set_gc_dash.
	(style_border_set_pc) : New routine cloned from style_border_set_gc.
	(style_border_print) : New routine cloned from style_border_draw.

	* src/cell-draw.c (cell_draw) : No need to return number of spans.

2000-02-29  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/sheet.c (sheet_new): Added initialization of all the Solver
 	parameters.
	
	* src/xml-io.c: Enabled the solver parameter saving again.

2000-02-29  Jon K Hellan  <hellan@acm.org>

	* src/gnumeric-util.[ch] (gnumeric_set_transient): New
	function. Make the window a child of the workbook in the command
	context, if there is one. 
	(gnumeric_editable_enters): New function. Like
	gnome_dialog_editable_enters, but not just for GnomeDialogs.

	* src/gnumeric-util.c (gnumeric_dialog_run): Remove incorrect
	comment.
	(gnumeric_dialog_show): Fix typo.

2000-02-29  Jon K Hellan  <hellan@acm.org>

	* src/dialogs/dialog-cell-format.c: The dialog moved when "Apply"
	was pressed. This was an unavoidable consequence of using
	gnome_dialog_run. We switch to a purely callback based design -
	this module was almost there, anyway. And we can make the dialog
	modeless if we wish.
	(cb_fmt_dialog_dialog_destroy): New function. Free resources upon
	"destroy". This gets called whenever "OK" or "WM close" are
	pressed.
	(fmt_dialog_impl): Connect "destroy" handler. Replace
	gnome_dialog_run (recursive main loop) with gnumeric_dialog_show
	(no such thing). Set modal explicitly.
	(dialog_cell_format): Remove initial comment which these changes
	made incorrect. Allocate state record on heap instead of stack.
	Move resource deallocation to cb_fmt_dialog_destroy.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/value.c (value_new_cellrange) : Normalize ranges
	  to ensure that start <= end.

2000-02-28  Morten Welinder  <terra@diku.dk>

	* src/datetime.c (datetime_serial_raw_to_serial): Use floor.
	(datetime_serial_raw_to_seconds): Ditto.

	* src/format.c (format_number): Keep the sign when considering
 	dates.

	* src/parser.y (unregister_allocation): Handle special error
 	situation without issueing a bogus message.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/selection.c (sheet_selection_walk_step) : Fix typo.

2000-02-28  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/widgets/widget-color-combo.c (color_combo_finalize): Memory
	leak fix.  Found by Morten.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-view.c (button_select_all) : Redraw after selection.

	* src/selection.c (sheet_selection_walk_step) : Don't wrap when moving
	  the singleton cursor.

	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) :
	   - Shift tab should be horizonzontal.
	   - Shift/None Tab/Enter should accept pending input.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/expr.h : Move FunctionDefinition to
	* src/gnumeric.h : here.

	* src/cellspan.c (col_hash) : Use GPOINTER_TO_INT.
	(col_compare) : Ditto.
	(row_init_span) : Delete.
	(free_hash_value) : Renamed from free_hash_key.
	(cell_register_span) : Register all cells in a span, malloc a
	  CellSpanInfo to store a descriptor about the first and last cols.
	(assemble_unregister_span_list) : Delete.
	(span_remove) : New function for use by g_hash_table_foreach_remove.
	(cell_unregister_span) : Use g_hash_table_foreach_remove.
	(row_cell_get_displayed_at) : Adjust to new descriptor.
	(row_span_get) : New function.

	* src/cell.c (cell_calculate_span) : Renamed from cell_get_span.

	* src/cell-draw.c (cell_draw) : Do not draw backgrounds here.
	  Use new CellSpanInfo to avoid recomputing spans every time.
	(cell_is_blank) : Remove hack about treating empty strings as empty.

	* src/cellspan.h : New file.  Move span decls here.

	* src/item-grid.c (item_grid_draw) : Rework to correctly handle
	  backgrounds and borders for spanning columns.

2000-02-27  Jody Goldberg <jgoldberg@home.com>

	* src/cell.c (cell_is_blank) : Update.

	* src/border.c (style_border_draw) : Make somewhat more correct.
	  Still broken for non-top-left corners.

	* src/item-grid.c (item_grid_draw_border) : Ditto.
	(item_grid_draw_background) : Rename from item_grid_paint_empty_cell
	  handle spans more cleanly.
	(item_grid_draw_cell) : handle conditionals for displaying contents here.
	  Remove all handling of backgrounds.

2000-02-28  Michael Meeks  <michael@helixcode.com>

	* src/xml-io.c (xml_sheet_read, xml_sheet_write): kill for now.

2000-02-28  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/utils.c (parse_cell_name_or_range): Bug fix.  Single cell
	constraints can be added again.

	* src/solver-lp.c (count_dimensions, make_solver_arrays,
	solver_affine_scaling, solver_branch_and_bound): The Solver can
	now solve the negative variables too.

	* src/dialogs/dialog-solver.c (dialog_solver_options): Made the
	`Assume non-negative' to be sensitive.
	
2000-02-28  Morten Welinder  <terra@diku.dk>

	* src/format.c (render_number): Move calculation of thousand's sep
 	outside the loop.  Avoid calculations way beyond double's
 	precision.

2000-02-24  Dom Lachowicz <dominicl@seas.upenn.edu>
 
 	* src/functions/fn-eng.c (convert): catch DIV0
 
 	* src/functions/fn-financial.c (gnumeric_accrint), (gnumeric_accrintm),
 	(gnumeric_intrate), (gnumeric_disc), (gnumeric_db),
 	(gnumeric_ddb), (gnumeric_mirr), (gnumeric_pv): More errors.
 
 	* src/function/fn-math.c (gnumeric_quotient): ditto.
 
 	* src/function/fn-stat.c (callback_function_stat),
	(callback_function_chitest_theoretical, gnumeric_betadist),
	(gnumeric_confidence, gnumeric_ftest): ditto.
 	
2000-02-27  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/solver-lp.c, src/dialogs/dialog-solver.c: Constraints can
	now also be cell ranges.
	(write_constraint_str): Wrote.

	* src/utils.[ch] (parse_cell_name_or_range): Wrote.

	* src/xml-io.c: Related changes.
	
2000-02-26  Jon K Hellan  <hellan@acm.org>

	* doc/python-gnumeric.txt: New file. Documents the Python plugin.

2000-02-26  Jody Goldberg <jgoldberg@home.com>

	* src/formats.c (CurrencySymbol) : Add symbols and names to
	  translation list.

	* src/workbook.c (insert_object_cmd) : Bug 6499.
	  Move Define name to the insert menu to avoid conflict.

2000-02-26  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/xml-io.c (xml_read_solver): New. (xml_write_solver): New.
	Added saving and loading of the Solver parameters.  The parameters
	are per sheet.

	* src/dialogs/dialog-solver.c: A few bug fixes and improvements.
	
2000-02-22  Jody Goldberg <jgoldberg@home.com>

        * src/workbook-format-toolbar.c
        (workbook_format_toolbutton_update) : new.
        (workbook_format_halign_feedback_set) : new
        (workbook_feedback_set) : Use the new functions.
        (set_selection_halign) : ditto.

2000-02-25  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/mathfunc.[ch]: Implemented Branch-And-Bound algorithm for
	integer programming.

	* src/solver-lp.c (count_dimensions): Wrote.
	(make_solver_arrays): Wrote.
	(make_int_array): Wrote.
	(solver_branch_and_bound): Wrote.  Solver can now handle the
	`Int' constraints too.
	(solver_lp): Wrote.

	* src/solver.h: Added prototype.

	* src/dialogs/dialog-solver.c: Related changes.

2000-02-25  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/Makefile.am (-DGNUMERIC_GLADEDIR): Removed iconsdir if it is
	not going to get used.

2000-02-24  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/widgets/widget-color-combo.c (color_combo_construct): Fix
	indentation.

	* src/sheet-object-container.c (sheet_object_container_realize):
	OOPS.  Add uih back.

	* Fresh ChangeLog.

