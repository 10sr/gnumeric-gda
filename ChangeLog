2004-02-01  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_toolbar_timer_clear) : people
	  didn't like it so remove it to allow custom color selection to work.
	  With it in place the action was still insensitive when the
	  color_changed fired so the activation was ignored.

	* src/wbc-gtk.c (wbc_gtk_init) : connect the post_activate signal
	  as a swapped_object to avoid calling it after we use an accelerator
	  to quit.

2004-02-01  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gu_delete_handler): new
	(gnumeric_dialog_file_selection): catch window manager deletion 
	  of the dialog.

2004-01-28  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=131933
	* src/format.c (update_lc) : catch mismatched monetary and numeric
	  locales that set result in the decimal seperator and thousands
	  seperator being the same.

2004-01-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas.in: Add schemas correponding to 
	  the new printing keys.

2004-01-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-gconf-priv.h: add many more printing related keys
	* src/gnumeric-gconf.c (gnm_conf_init_essential): initialize 
	  printing variables from gconf
	(gnm_gconf_set_print_center_horizontally): implement
	(gnm_gconf_set_print_center_vertically): implement
	(gnm_gconf_set_print_grid_lines): implement
	(gnm_gconf_set_print_even_if_only_styles): implement
	(gnm_gconf_set_print_black_and_white): implement
	(gnm_gconf_set_print_titles): implement
	(gnm_gconf_set_print_order_right_then_down): implement
	(gnm_gconf_set_print_scale_percentage): implement
	(gnm_gconf_set_print_scale_percentage_value): implement
	(gnm_gconf_set_print_scale_width): implement
	(gnm_gconf_set_print_scale_height): implement
	(gnm_gconf_set_print_repeat_top): implement
	(gnm_gconf_set_print_repeat_left): implement
	(gnm_gconf_set_print_tb_margins): implement
	(gnm_gconf_set_print_header_formats): implement
	* src/print-info.c (load_formats): add saved custom formats

2004-01-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-gconf.c (gnm_conf_init_essential): initialize new
	  configuration variables
	(gnm_conf_init_extra): move some items to essential
	(gnm_gconf_set_print_center_horizontally): new stub
	(gnm_gconf_set_print_center_vertically): new stub
	(gnm_gconf_set_print_grid_lines): new stub
	(gnm_gconf_set_print_even_if_only_styles): new stub
	(gnm_gconf_set_print_black_and_white): new stub
	(gnm_gconf_set_print_titles): new stub
	(gnm_gconf_set_print_order_right_then_down): new stub
	(gnm_gconf_set_print_scale_percentage): new stub
	(gnm_gconf_set_print_scale_percentage_valuee): new stub
	(gnm_gconf_set_print_scale_width): new stub
	(gnm_gconf_set_print_scale_height): new stub
	(gnm_gconf_set_print_repeat_top): new stub
	(gnm_gconf_set_print_repeat_left): new stub
	(gnm_gconf_set_print_tb_margins): new stub
	(gnm_gconf_set_print_header_formats): new stub
	* src/gnumeric-gconf.h: various new functions (see above) and 
	  fields to the pref structure.
	* src/print-info.c: remove dependence on libgnome/gnome-config.h
	(load_margin): deleted
	(load_hf): deleted
	(load_range): deleted
	(load_formats): remove gnome-config stuff
	(print_info_new): switch to gconf functions
	(save_margin): deleted
	(save_range): deleted
	(save_hf): deleted
	(save_formats): use gconf
	(print_info_save): use new gconf functions
	(print_info_set_orientation): new
	(print_info_get_orientation): new
	* src/print-info.h: remove orientation field in pi
	(print_info_set_orientation): new
	(print_info_get_orientation): new
	* src/xml-io.c (xml_write_print_info): use print_info_get_orientation
	(xml_read_print_info): use print_info_set_orientation

2004-01-27  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_save_as): Switch to file chooser.

2004-01-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (sheet_print): remove warnings

2004-01-27  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_open): Cleanup and hack a better size.

2004-01-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* configure.in: bump libgnomeprint[ui] requirement to 2.5.2
	* src/print.c (sheet_print): don't close the print dialog on preview
	  and use gnome_print_dialog_run to avoid overwriting files without
	  dialog

2004-01-26  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_open): Switch to file chooser.

	* src/gui-util.c (gnumeric_dialog_file_selection): Handle file
	chooser widgets too.

2004-01-26  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=132448
	* src/wbcg-actions.c (cb_auto_filter) : fix
	* src/selection.c (selection_first_range) : improve readability of
	  error message.

	http://bugzilla.gnome.org/show_bug.cgi?id=127138
	* src/wbcg-actions.c (cb_view_freeze_panes) : Don't get confused by an
	  attempt to freeze without centering when the top or left is not 0.

2004-01-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/cell-draw.c (cell_calc_layout): new
	(cell_draw): move the pango layout code into cell_calc_layout

2004-01-24  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-graphic.c : defaults for color combos are now more
	  useful.  The actions can set them up for toolbars in one place
	  rather than users setting the combo in dozens.

2004-01-23  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_find_command) : new utility

	* src/wbc-gtk.c (cb_undo_activated) : port to new interface
	(cb_redo_activated) : port to new interface

	* src/sheet-control-gui.c (scg_object_update_bbox) : silence
	  irritating warning.

2004-01-23  Jody Goldberg <jody@gnome.org>

	* configure.in : bump the gtk and glib depends to yesterday's releases

2004-01-22  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : clean up the border combo and adapt to its new api

2004-01-16  Jody Goldberg <jody@gnome.org>

	* configure.in : check for symbolic link support
	* src/Makefile.am : install executable as
	    gnumeric-<version>
	  with a symlink to that from gnumeric

2004-01-16  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_write_workbook) : update the string and drop the
	  warning.

	* src/wbc-gtk.c (wbc_gtk_init) : enable translations for menus and
	  toolbars.

2004-01-16  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : Fix some accelerators and enable colour combos.
	  Some undo/redo is working too.

	* src/style-color.c (style_color_new_go) : new.

	* configure.in : Push the goffice include up here until it can get a
	  pkg file.

	* autogen.sh (REQUIRED_AUTOMAKE_VERSION) : bump automake version to
	  get stricter distchecks.

2004-01-14  Jody Goldberg <jody@gnome.org>

	* gnumeric.mime : prune this to just types gnome-mime-data does not
	  appear to have.

2004-01-15  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=131343
	* src/print.c (print_job_info_update_from_config): new
	(print_job_info_get): move some code into 
	  print_job_info_update_from_config
	(sheet_print): call print_job_info_update_from_config after the
	  user may have changed the paper info in the print dialog.

2004-01-14  Jon K Hellan  <hellan@acm.org>

	* README: Spellcheck

2004-01-14  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : silence some warnings from the zoom combo.  It's not
	  functional yet so why spew errors.
	- Add status line display of menu tooltips
	- Fix accel for the display formula toggle

2004-01-13  Jody Goldberg <jody@gnome.org>

	* src/func.c (function_call_with_list) : fix the address tests by
	  allowing missing optional args to get passed as NULL.

2004-01-12  Morten Welinder  <terra@gnome.org>

	* src/GNOME_Gnumeric-gtk.xml: remove menu entris for bold, etc.
	(Probably accidentally committed.)

2004-01-11  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric-gtk.xml: Add accelerators for bold, italic
	and underline.

2004-01-10  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : Display the progress bar
	  enable the sensitzation/desensitization of the actions.  NOTE :
	  requires a gtk patch that is not in cvs yet.
	  Set a tooltip for the border and colour combos, requires another gtk
	  patch that is not in cvs.

	* src/gnumeric-pane.c : Conditionally disable the stipple border for
	  now, but fix it to scale properly with zoom anyway.

	* src/Makefile.am (bonobo_component_ui_DATA) : install the GtkAtion ui
	  file for now.  We can cleanup later.  Display ssconvert too, that
	  needs to merge or move to a new dir.  It doubles link time.

2004-01-09  Morten Welinder  <terra@gnome.org>

	* src/wbcg-actions.c: Add invisible CopyDown and CopyRight
	actions.  Stubbed so far.
	Remove accelerator for double underline as it collided with
	single underline.

2004-01-08  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=130172
	* src/func.c (function_call_with_list) : A major change
	  Do not do the empty conversion to int(0) in expr_eval
	  ALLOW scalars to return empty/NULL, the convert them to empty for
	  most types, and int(0) for float/bool.  Which makes
	  'S' the same as 's' for all purposes accept documentation.

	* src/GNOME_Gnumeric-gtk.xml : No need to name items their action is
	  sufficient as long as they are unique in their parent.

	* src/cell.h (CELL_HAS_NEW_EXPR) : AARRRGGH.  Actually a sign a
	  _unique_ value to it.

	* src/gnumeric-pane.c (cb_control_point_event) : change the cursor
	  when dragging.  Only start dragging on button 1 down.  Ignore other
	  buttons while dragging.
	(cb_sheet_object_canvas_event) : ditto.

	* src/main-application.c (main) : set the app name.

2004-01-07  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=130700
	* src/format.c (format_entry_ctor) : init the new 'suppress_minus'
	  entry.
	(format_compile) : initialize supress minus if the condition is of the
	  form [<=(val <= 0)] or [<(val < 0)] I hope this is a reasonable
	  approximation of MS Excel.
	(render_number) : pull out all the old elements that added minus signs
	(format_number) : handle the new entry based suppress minus operator
	  here, and prepend the sign.

	* src/wbcg-actions.c : Sync labels and mnemonics with the old
	  bonobo/gnomeui menus

2004-01-06  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c (cb_add_menus_toolbars) : Enable/Disable the arrow
	  contraction on the toolbars if the handlbox is docked/undocked.
	  This avoids having floating toolbars with nothing but the collapse
	  arrow.

	* configure.in : re-enable the *DEPRECATED*
	and add a pile of #undef/#warning to make sure things still work

2004-01-06  Jody Goldberg <jody@gnome.org>

	The initial pass at GtkAction custom combos are mucho broken
	* src/sheet.c (sheet_toggle_hide_zeros) : move this out of the macro
	  in wbcg.
	(sheet_toggle_show_formula) : ditto.

	* src/sheet-object-graph.c (cb_save_as) : add jpg, and translate the
	  error message now that string freeze is done.

	* src/gui-util.c : restore DISABLE_DEPRECATED
	(gnumeric_toolbar_insert_with_eventbox) : delete.
	(gnumeric_toolbar_append_with_eventbox) : delete.
	(gtk_button_stock_alignment_set) : delete.
	(gnumeric_toolbar_new) : delete.
	(gnumeric_inject_widget_into_bonoboui) : move the wbc-bonobo.c
	(gnumeric_toolbar_get_widget) : delete.
	(gnm_widget_disable_focus) : move here from workbook-format-toolbar.c

	* workbook-format-toolbar.{c,h} : move contents into
	* wbcg-actions.c : this new file
	* wbc-gtk.c : or this new file
	* wbc-bonobo.c : or this new file (WHICH DOES NOT COMPILE OR WORK)
	  Should probably merge into workbook-control-component or something
	  like that

	* src/gnm-marshalers.list (VOID) : Use the stock marshallers in glib
	  directly rather than adding our own wrappers.
	* src/application.c : here

	* src/GNOME_Gnumeric.xml : rename FileExit -> FileQuit to be consistent
	* src/GNOME_Gnumeric-gtk.xml : new file for GtkAction
	  NOTE NOTE NOTE
	  You must be running in gnumeric/src
	  I Repeat
	  YOU MUST BE RUNNING IN gnumeric/src
	  for anything to work right now.  I don't quite know how I want to
	  handle the file yet (the bonobo approach was irritating) we'll see.

	* configure.in :
	- Add goffice/gui-utils
	- Get rid of --with-bonobo
	- Add --with-gnome
	- Add --enable-bonobo-component
	* plugins/Makefile.am : Adapt to that.
	* src/Makefile.am : ditto, and add the new files.

2004-01-05  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=130424
	* src/commands.c (cmd_set_text_redo) : remove manual kludge.
	* src/dependent.h (cell_eval) : move from here
	* src/cell.h (cell_eval) : to here.  Add a new flag CELL_HAS_NEW_EXPR
	* src/cell.c (cell_set_expr_internal) : set the flag here.
	* src/rendered-value.c (rendered_value_new) : test it here.

	http://bugzilla.gnome.org/show_bug.cgi?id=130582
	* src/sheet-control-gui.c (scg_cursor_move) : don't scroll the other
	  panes unless we absolutely have to.  Apparently we only fuxed normal
	  cursor movement for http://bugzilla.gnome.org/show_bug.cgi?id=77303
	  This fixes rangesel too.

2003-12-29  Jody Goldberg <jody@gnome.org>

	* * : Move everything to glib/gi18n.h in place of gnumeric-i18n.h
	* gnumeric-i18n.h : delete

	* configure.in : Looks like we're really requiring gtk/glib 2.3.1 at a
	  minimum.  In reality it's probably closer to CVS at this point.  I'm
	  kinda looking forward to the gtk freeze.

2003-12-24  Morten Welinder  <terra@gnome.org>

	* src/io-context-gtk.c (cb_realize): Remove workaround for old
	gtk.
	* src/stf-parse.c (stf_parse_lines): Ditto.
	* src/workbook-control-gui.c (wbcg_get_gtk_settings): Ditto.
	(show_gui): Ditto.

	* src/gui-util.c (gdk_cursor_new_from_pixbuf): Remove.

2003-12-23  Jody Goldberg <jody@gnome.org>

	* configure.in : post BRANCH bump
	  require gtk/glib 2.3.0, that will probably go up shortly
	  as we depend more on head directly
