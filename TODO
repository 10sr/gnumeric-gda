
GNOME Spread Sheet task list

* Parser
  
  The parser should understand the Excel syntax for expressions.  This
is the API we need:

GList *evaluate (Sheet     *sheet, 
		 char      *expression, 
		 Type      *result_type,
		 ValueType *val, 
		 char      **error_string);

Input values:
	Sheet		Is the Sheet the cell is part of.
	expression	Is the expression to be evaluated

Return value:
	GList *		A list of any cells referenced.

Output values (pointed destination holds result)
	result_type	Is set us the type of the expression, check
			the header files for details.
	val		The val union set properly to the computed expression
			if no error was set.
	error_string	if error_string is NULL, then no error was found,
			otherwise it points to the error string that gets
			displayed by the spreadsheet.

 The expressions parsed should be compatible with what Excel accepts.

* Information formatting

	Given the Cell structure in cell.h:

	if the Cell->content_type is either VALUE_INTEGER or VALUE_FLOAT,
        produce a formatted string based Excel-compatible format.

	I should mention again this: The format that the routine takes
	should be compatible with the Excel format.

	Desired API:

	char *format_number (Value value, GdkColor *computed_color)

	Input values:
		value	The value that is either a VALUE_INTEGER or
			a VALUE_FLOAT

	Returned value:
	char*		The formatted string.

	Other Output values:
	computed_color	This is a GdkColor set to the color computed
			by the format_number routine (yes, the format
			can include colors for certain conditions).

* Engine

    Keeps track of the actual spreadsheet internal representation,
does the calculation, deals with the events from any of the display
frontends and updates the visual representations based on the events
that it receives. 

** Style manager

    This keep track of the styles that apply to every cell displayed.
It takes care of per-cell, per-column, per-row, per-sheet and
per-workbook styles and does the style computation for every cell on
the spreadsheet based on the styles the user has set. 

** Dislay engine

    The display engine is a derived widget from the GNOME canvas
widget: this allows for graphics, widgets and decorations to be added
to the spreadsheet with a minimal amount of work.  The GNOME
spreadsheet widget is both a derived type of the Canvas and provides a
specific Canvas-Item that implements the actual spreadsheet to be
drawn. 

*** Cell display engine

	Displays the cell contents according to the format
	information.  This gets specific formating requirements for
	the currently displayed region from the engine. 

**** Selections

	The display engine needs to support a number of display features:

		1. Cursor display: this shows the cursor position and
		the selection range.  The range fill little bottom
		right box is displayed in the selected region. 

		2. Walking ants region: a region that has a walking
		ants selection.

		3. Cell being edited: Only the external borders for
		the cursor are shown, the internal lines are hidden.

*** Graphic dislay engine

	As the spreadsheet is derived from the Gnome Canvas, this only
	keeps track of the correct zoom factor and addresses the basic
	drawing needs required for an Excel-like spreadsheet.

* Doom

	We need to get a GtkDoom widget, for putting it on the About
	box of the spreadsheet.
