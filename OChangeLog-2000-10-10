2000-02-29  Jon K Hellan  <hellan@acm.org>

	* src/gnumeric-util.[ch] (gnumeric_set_transient): New
	function. Make the window a child of the workbook in the command
	context, if there is one. 
	(gnumeric_editable_enters): New function. Like
	gnome_dialog_editable_enters, but not just for GnomeDialogs.

	* src/gnumeric-util.c (gnumeric_dialog_run): Remove incorrect
	comment.
	(gnumeric_dialog_show): Fix typo.

2000-02-29  Jon K Hellan  <hellan@acm.org>

	* src/dialogs/dialog-cell-format.c: The dialog moved when "Apply"
	was pressed. This was an unavoidable consequence of using
	gnome_dialog_run. We switch to a purely callback based design -
	this module was almost there, anyway. And we can make the dialog
	modeless if we wish.
	(cb_fmt_dialog_dialog_destroy): New function. Free resources upon
	"destroy". This gets called whenever "OK" or "WM close" are
	pressed.
	(fmt_dialog_impl): Connect "destroy" handler. Replace
	gnome_dialog_run (recursive main loop) with gnumeric_dialog_show
	(no such thing). Set modal explicitly.
	(dialog_cell_format): Remove initial comment which these changes
	made incorrect. Allocate state record on heap instead of stack.
	Move resource deallocation to cb_fmt_dialog_destroy.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/value.c (value_new_cellrange) : Normalize ranges
	  to ensure that start <= end.

2000-02-28  Morten Welinder  <terra@diku.dk>

	* src/datetime.c (datetime_serial_raw_to_serial): Use floor.
	(datetime_serial_raw_to_seconds): Ditto.

	* src/format.c (format_number): Keep the sign when considering
 	dates.

	* src/parser.y (unregister_allocation): Handle special error
 	situation without issueing a bogus message.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/selection.c (sheet_selection_walk_step) : Fix typo.

2000-02-28  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/widgets/widget-color-combo.c (color_combo_finalize): Memory
	leak fix.  Found by Morten.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-view.c (button_select_all) : Redraw after selection.

	* src/selection.c (sheet_selection_walk_step) : Don't wrap when moving
	  the singleton cursor.

	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) :
	   - Shift tab should be horizonzontal.
	   - Shift/None Tab/Enter should accept pending input.

2000-02-28  Jody Goldberg <jgoldberg@home.com>

	* src/expr.h : Move FunctionDefinition to
	* src/gnumeric.h : here.

	* src/cellspan.c (col_hash) : Use GPOINTER_TO_INT.
	(col_compare) : Ditto.
	(row_init_span) : Delete.
	(free_hash_value) : Renamed from free_hash_key.
	(cell_register_span) : Register all cells in a span, malloc a
	  CellSpanInfo to store a descriptor about the first and last cols.
	(assemble_unregister_span_list) : Delete.
	(span_remove) : New function for use by g_hash_table_foreach_remove.
	(cell_unregister_span) : Use g_hash_table_foreach_remove.
	(row_cell_get_displayed_at) : Adjust to new descriptor.
	(row_span_get) : New function.

	* src/cell.c (cell_calculate_span) : Renamed from cell_get_span.

	* src/cell-draw.c (cell_draw) : Do not draw backgrounds here.
	  Use new CellSpanInfo to avoid recomputing spans every time.
	(cell_is_blank) : Remove hack about treating empty strings as empty.

	* src/cellspan.h : New file.  Move span decls here.

	* src/item-grid.c (item_grid_draw) : Rework to correctly handle
	  backgrounds and borders for spanning columns.

2000-02-27  Jody Goldberg <jgoldberg@home.com>

	* src/cell.c (cell_is_blank) : Update.

	* src/border.c (style_border_draw) : Make somewhat more correct.
	  Still broken for non-top-left corners.

	* src/item-grid.c (item_grid_draw_border) : Ditto.
	(item_grid_draw_background) : Rename from item_grid_paint_empty_cell
	  handle spans more cleanly.
	(item_grid_draw_cell) : handle conditionals for displaying contents here.
	  Remove all handling of backgrounds.

2000-02-28  Michael Meeks  <michael@helixcode.com>

	* src/xml-io.c (xml_sheet_read, xml_sheet_write): kill for now.

2000-02-28  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/utils.c (parse_cell_name_or_range): Bug fix.  Single cell
	constraints can be added again.

	* src/solver-lp.c (count_dimensions, make_solver_arrays,
	solver_affine_scaling, solver_branch_and_bound): The Solver can
	now solve the negative variables too.

	* src/dialogs/dialog-solver.c (dialog_solver_options): Made the
	`Assume non-negative' to be sensitive.
	
2000-02-28  Morten Welinder  <terra@diku.dk>

	* src/format.c (render_number): Move calculation of thousand's sep
 	outside the loop.  Avoid calculations way beyond double's
 	precision.

2000-02-24  Dom Lachowicz <dominicl@seas.upenn.edu>
 
 	* src/functions/fn-eng.c (convert): catch DIV0
 
 	* src/functions/fn-financial.c (gnumeric_accrint), (gnumeric_accrintm),
 	(gnumeric_intrate), (gnumeric_disc), (gnumeric_db),
 	(gnumeric_ddb), (gnumeric_mirr), (gnumeric_pv): More errors.
 
 	* src/function/fn-math.c (gnumeric_quotient): ditto.
 
 	* src/function/fn-stat.c (callback_function_stat),
	(callback_function_chitest_theoretical, gnumeric_betadist),
	(gnumeric_confidence, gnumeric_ftest): ditto.
 	
2000-02-27  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/solver-lp.c, src/dialogs/dialog-solver.c: Constraints can
	now also be cell ranges.
	(write_constraint_str): Wrote.

	* src/utils.[ch] (parse_cell_name_or_range): Wrote.

	* src/xml-io.c: Related changes.
	
2000-02-26  Jon K Hellan  <hellan@acm.org>

	* doc/python-gnumeric.txt: New file. Documents the Python plugin.

2000-02-26  Jody Goldberg <jgoldberg@home.com>

	* src/formats.c (CurrencySymbol) : Add symbols and names to
	  translation list.

	* src/workbook.c (insert_object_cmd) : Bug 6499.
	  Move Define name to the insert menu to avoid conflict.

2000-02-26  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/xml-io.c (xml_read_solver): New. (xml_write_solver): New.
	Added saving and loading of the Solver parameters.  The parameters
	are per sheet.

	* src/dialogs/dialog-solver.c: A few bug fixes and improvements.
	
2000-02-22  Jody Goldberg <jgoldberg@home.com>

        * src/workbook-format-toolbar.c
        (workbook_format_toolbutton_update) : new.
        (workbook_format_halign_feedback_set) : new
        (workbook_feedback_set) : Use the new functions.
        (set_selection_halign) : ditto.

2000-02-25  Jukka-Pekka Iivonen  <iivonen@iki.fi>

	* src/mathfunc.[ch]: Implemented Branch-And-Bound algorithm for
	integer programming.

	* src/solver-lp.c (count_dimensions): Wrote.
	(make_solver_arrays): Wrote.
	(make_int_array): Wrote.
	(solver_branch_and_bound): Wrote.  Solver can now handle the
	`Int' constraints too.
	(solver_lp): Wrote.

	* src/solver.h: Added prototype.

	* src/dialogs/dialog-solver.c: Related changes.

2000-02-25  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/Makefile.am (-DGNUMERIC_GLADEDIR): Removed iconsdir if it is
	not going to get used.

2000-02-24  Miguel de Icaza  <miguel@nuclecu.unam.mx>

	* src/widgets/widget-color-combo.c (color_combo_construct): Fix
	indentation.

	* src/sheet-object-container.c (sheet_object_container_realize):
	OOPS.  Add uih back.

	* Fresh ChangeLog.

